{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?7970","webpack:///./src/components/Graph.vue?52fd","webpack:///./src/App.vue?4050","webpack:///./src/components/CollapsiblePane.vue?67bd","webpack:///./src/components/CollapsiblePane.vue?1fa9","webpack:///./src/components/CollapsiblePane.vue?0878","webpack:///./src/components/CollapsiblePane.vue","webpack:///./src/components/Graph.vue?12dc","webpack:///./src/graph/base/EventEmitter.ts","webpack:///./src/graph/edge/type/EdgeType.ts","webpack:///./src/graph/edge/type/StraightEdgeType.ts","webpack:///./src/graph/base/Positioned.ts","webpack:///./src/graph/edge/type/QuadraticEdgeType.ts","webpack:///./src/graph/edge/type/index.ts","webpack:///./src/graph/edge/Edge.ts","webpack:///./src/graph/graph/layout/GraphLayout.ts","webpack:///./src/graph/graph/layout/KamadaKawaiGraphLayout.ts","webpack:///./src/graph/graph/layout/index.ts","webpack:///./src/graph/graph/component/ComponentLayout.ts","webpack:///./src/graph/graph/component/LinearComponentLayout.ts","webpack:///./src/graph/graph/component/index.ts","webpack:///./src/graph/graph/type/GraphType.ts","webpack:///./src/graph/graph/type/BoxGraphType.ts","webpack:///./src/graph/graph/type/index.ts","webpack:///./src/graph/base/Port.ts","webpack:///./src/graph/graph/physics/GraphPhysics.ts","webpack:///./src/graph/graph/physics/BarnesHutGraphPhysics.ts","webpack:///./src/graph/graph/physics/index.ts","webpack:///./src/graph/node/type/recordParser.ts","webpack:///./src/graph/graph/Graph.ts","webpack:///./src/graph/node/type/NodeType.ts","webpack:///./src/graph/node/type/BoxNodeType.ts","webpack:///./src/graph/node/type/RecordCell.ts","webpack:///./src/graph/node/type/RecordNodeType.ts","webpack:///./src/graph/node/type/TableCell.ts","webpack:///./src/graph/node/type/TableNodeType.ts","webpack:///./src/graph/node/type/index.ts","webpack:///./src/graph/node/Node.ts","webpack:///./src/graph/base/renderableFactory.ts","webpack:///./src/graph/examples/stdThreadJoin.gv","webpack:///./src/graph/examples/stdThreadJoin.txt","webpack:///./src/graph/examples/record.txt","webpack:///./src/graph/examples/subgraph.txt","webpack:///./src/graph/examples/icosahedron.txt","webpack:///./src/graph/examples/table.txt","webpack:///./src/graph/examples/edge.txt","webpack:///./src/graph/Root.ts","webpack:///./src/components/renderable/MyCanvas.vue?e43e","webpack:///./src/components/renderable/MyCanvas.vue?a98f","webpack:///./src/components/renderable/MyCanvas.vue?dfe4","webpack:///./src/components/renderable/MyCanvas.vue","webpack:///./src/components/Graph.vue?b1ea","webpack:///./src/components/Graph.vue?becd","webpack:///./src/components/Graph.vue","webpack:///./src/App.vue?ec60","webpack:///./src/App.vue?640d","webpack:///./src/App.vue","webpack:///./src/main.ts","webpack:///./src/components/CollapsiblePane.vue?6677"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","_v","class","settingsOpen","on","$event","_e","_g","desktopLayout","assign","sizerMouseActive","mouseup","onMainSizerMouseUp","mousemove","onMainSizerMouseMove","sizerTouchActive","touchend","onMainSizerTouchEnd","touchmove","onMainSizerTouchMove","style","width","settingsWidth","ref","_s","parseError","canvasWidth","canvasHeight","rendered","left","onMainSizerMouseDown","onMainSizerTouchStart","inputFileChange","directives","rawName","expression","$$selectedVal","Array","filter","target","options","selected","map","val","_value","parser","multiple","redraw","_l","example","selectExample","realSettingsWidth","domProps","composing","rawInput","parsedInput","staticRenderFns","click","title","expand","animationHeight","height","_t","realHeight","content","$refs","paneContent","offsetHeight","addEventListener","transitionEnd","setTimeout","String","mainCanvasData","mousedown","wheel","mouseDragActive","thumbnailWidth","thumbnailHeight","thumbnailCanvasData","thumbnailMousedown","thumbnailMouseDragActive","thumbnailMouseup","thumbnailMousemove","events","event","listener","undefined","index","indexOf","args","parent","config","StraightEdgeType","defaultConfig","graph","Error","fromNode","findPort","from","split","toNode","to","fromPos","getAbsolutePosition","toPos","fromAngle","Math","atan2","y","x","toAngle","PI","fromDistance","distanceToBorder","toDistance","realFromPosX","cos","realFromPosY","sin","realToPosX","realToPosY","children","fromPointer","is","angle","pointerWidth","pointerHeight","fill","pointerColor","toPointer","unshift","points","stroke","lineColor","strokeWidth","lineWidth","id","position","node","QuadraticEdgeType","controlPoint","setPosition","getPosition","viaPos","edgeTypeFactory","shape","root","Edge","getId","fullId","parentId","typeClass","edgeType","constructor","setData","render","newConfig","KamadaKawaiGraphLayout","portToIndex","Map","ports","set","port","initialPlaced","springLength","random","distanceMatrix","Infinity","edges","fromBelonging","toBelonging","fromIndex","toIndex","k","dist","lengthMatrix","kMatrix","springConstant","pow","energyMatrix","mPos","iPos","denominator","sqrt","energySum","sum","maxEnergy","threshold","maxIterations","max","min","maxInnerIterations","iterations","deDx","deDy","e","delta","subIterations","d2eDx2","d2eDxDy","d2eDy2","factor","dx","dy","sumX","sumY","oldDx","oldDy","deltaX","deltaY","upperLeft","lowerRight","pos","size","getBoundingBoxSize","halfWidth","halfHeight","contentSize","layoutFactory","type","LinearComponentLayout","components","layouts","componentsSize","getContentSize","direction","reduce","a","b","spaceBetween","begin","componentFactory","BoxGraphType","layout","textSizeNeedsUpdate","label","fontSize","fontFamily","lineHeight","ctx","font","lines","textSize","measureText","layoutContentSize","componentLayout","padding","textPosition","labelPosition","borderSize","rect","fillColor","strokeColor","text","align","abs","graphTypeFactory","BarnesHutGraphPhysics","layoutData","physicsFactory","theta","gravitationalConstant","centralGravity","TokenEnum","Graph","newChildren","depth","child","renderableFactory","has","newChild","subgraphs","entries","renderable","adjacencyList","edgesData","values","edge","findBelongingPort","unvisited","Set","layoutsData","calculateConnectedComponent","delete","component","adjacency","next","portToComponent","edgeData","concat","componentClass","layoutClass","physicsClass","physics","newLayouts","newPhysics","solve","graphType","updated","subgraph","step","draggable","BoxNodeType","contentSizeNeedsUpdate","borderSizeNeedsUpdate","recordParser","record","buffer","lexer","pop","EOF","VERTICAL_BAR","LEFT_CURLY_BRACE","RIGHT_CURLY_BRACE","LEFT_ANGLE_BRACE","RIGHT_ANGLE_BRACE","STRING","parseRecordLabel","token","parseField","ret","tree","nodeType","isHorizontal","isField","fieldData","getPorts","getConfig","cellSize","recordData","cell","RecordCell","deltaWidth","startX","setCellSize","deltaHeight","startY","RecordNodeType","contentNeedsUpdate","borderNeedsUpdate","rootCellSize","getCellSize","founded","rowSpan","columnSpan","border","getTableConfig","cellBorder","backgroundColor","attributes","keys","attribute","toLowerCase","parseInt","getText","element","elements","join","parentConfig","tableConfig","cellPadding","rowOffset","columnOffset","TableNodeType","layoutNeedsUpdate","jsonObj","xml2js","tableElement","cellSpacing","table","rows","columns","firstRow","tr","row","td","getPort","cellSizes","cellHeight","cellWidth","rowHeight","columnWidth","accRowHeight","accColumnWidth","upperLeftX","upperLeftY","nodeTypeFactory","Node","document","createElement","getContext","stepTimer","setInterval","refresh","newClass","emit","globalRoot","globalParsers","json","input","JSON","parse","graphviz","globalExamples","stdThreadJoin","icosahedron","staticStyle","$listeners","provider","context","hitContext","hitColorMap","hitIdMap","canvas","enableHit","hitCanvas","round","g","color","hitCtx","clearRect","updateShape","draggableId","save","translate","scale","scaleX","scaleY","childShape","restore","beginPath","fillStyle","strokeStyle","finalDraggable","finalId","generateHitColor","linesWidth","posY","textBaseline","posX","fillText","moveTo","lineTo","quadraticCurveTo","middleX","middleY","closePath","outerLeft","outerTop","outerRight","outerBottom","innerLeft","innerTop","innerBottom","innerRight","pixel","getImageData","updateCanvas","Number","required","Boolean","draggedId","mouseLastCoords","maxThumbnailLength","minThumbnailLength","thumbnailPadding","thumbnailMouseLastCoords","updateSize","scaleBy","preventDefault","translateMouseEvent","mousePointTo","stageX","stageY","newPos","elementOffsetX","elementOffsetY","currentTarget","offsetLeft","offsetTop","offsetParent","pageX","pageY","mainCanvas","getIdFromHitPoint","buttons","newCoords","moveDraggable","thumbnailCanvas","oldCoords","thumbnailFactor","deepCopyAndRemoveDraggable","copy","viewportX","viewportY","viewportWidth","viewportHeight","default","minGraphWidth","minSettingsWidth","windowWidth","documentElement","clientWidth","windowHeight","clientHeight","examples","parsed","stringify","console","log","stack","getSize","updateCanvasSize","throttle","removeEventListener","parseInput","file","files","alert","reader","FileReader","onload","evt","readAsText","$nextTick","offsetWidth","mouseOffsetX","offsetX","touches","CollapsiblePane","productionTip","Icon","h","$mount"],"mappings":"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","file":"js/app.3d9fe9a0.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=stylus&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=stylus&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Graph.vue?vue&type=style&index=0&id=83e88e6a&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Graph.vue?vue&type=style&index=0&id=83e88e6a&lang=stylus&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('header',{staticClass:\"app-header\"},[_c('h1',{staticClass:\"title\"},[_vm._v(\"Graph Visualizer\")]),_c('div',{staticClass:\"settings\"},[(_vm.desktopLayout)?_c('div',{staticClass:\"settings-item\"},[_c('span',{staticClass:\"settings-item-title\",class:{ 'setting-item-active': _vm.settingsOpen },on:{\"click\":function($event){_vm.settingsOpen = !_vm.settingsOpen}}},[_vm._v(\"\\n          侧栏\\n        \")])]):_vm._e()])]),_c('main',_vm._g({staticClass:\"main-panes\",class:{\n          'main-panes-show-sidebarmain-panes-show-sidebar': _vm.settingsOpen && _vm.desktopLayout\n        }},Object.assign({}, _vm.sizerMouseActive ? {\n          mouseup: _vm.onMainSizerMouseUp,\n          mousemove: _vm.onMainSizerMouseMove\n        } : {}, _vm.sizerTouchActive ? {\n          touchend: _vm.onMainSizerTouchEnd,\n          touchmove: _vm.onMainSizerTouchMove\n        } : {})),[_c('div',{staticClass:\"main-container main-container-graph\",class:{ 'main-container-graph-size-active':\n                    !_vm.sizerMouseActive && !_vm.sizerTouchActive},style:({\n           width: _vm.desktopLayout ? (_vm.settingsOpen ?\n                  (\"calc(100% - \" + _vm.settingsWidth + \"px)\") : '100%') : 'auto'\n         })},[_c('div',{ref:\"canvas\",staticClass:\"main-pane main-pane-graph\"},[(_vm.parseError)?_c('div',{staticClass:\"error-pane\"},[_c('pre',[_c('code',[_vm._v(_vm._s(_vm.parseError))])])]):_vm._e(),_c('Graph',{ref:\"graph\",attrs:{\"width\":_vm.canvasWidth,\"height\":_vm.canvasHeight,\"data\":_vm.rendered}})],1)]),_c('transition',{attrs:{\"name\":\"sizer-slide-x\",\"duration\":300}},[(_vm.settingsOpen && _vm.desktopLayout)?_c('div',{staticClass:\"main-sizer main-client-settings-sizer\",style:({ left: (\"calc(100% - \" + _vm.settingsWidth + \"px)\") }),on:{\"mousedown\":_vm.onMainSizerMouseDown,\"touchstart\":_vm.onMainSizerTouchStart}},[_c('div',{staticClass:\"main-sizer-handlebar\"})]):_vm._e()]),_c('transition',{attrs:{\"name\":\"settings-slide-x\",\"duration\":300}},[(_vm.settingsOpen || !_vm.desktopLayout)?_c('div',{staticClass:\"main-container main-container-settings\",style:({\n             width: _vm.desktopLayout ? (_vm.settingsWidth + \"px\") : 'auto'\n           })},[_c('div',{staticClass:\"main-pane main-pane-settings\"},[_c('CollapsiblePane',{staticClass:\"main-pane-subpane\",attrs:{\"title\":\"输入\"}},[_c('div',{staticClass:\"settings-input-file\"},[_c('label',{attrs:{\"for\":\"input-file\"}},[_c('v-icon',{attrs:{\"name\":\"upload\",\"scale\":\"0.8\"}}),_vm._v(\"打开文件\\n              \")],1),_c('input',{attrs:{\"type\":\"file\",\"id\":\"input-file\"},on:{\"change\":_vm.inputFileChange}})]),_c('div',{staticClass:\"settings-input-format\"},[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.parser),expression:\"parser\"}],attrs:{\"id\":\"input-format\"},on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.parser=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},[_c('option',{attrs:{\"value\":\"json\",\"selected\":\"\"}},[_vm._v(\"JSON\")]),_c('option',{attrs:{\"value\":\"graphviz\"}},[_vm._v(\"Graphviz\")])])]),_c('button',{staticClass:\"setting-input-redraw\",on:{\"click\":_vm.redraw}},[_c('v-icon',{attrs:{\"name\":\"sync\",\"scale\":\"0.8\"}}),_vm._v(\"重绘\\n            \")],1),_c('div',{staticClass:\"settings-input-examples\"},[_c('span',{staticClass:\"settings-input-example-label\"},[_vm._v(\"示例：\")]),_vm._l((_vm.examples),function(example,i){return _c('span',{key:example.name,staticClass:\"settings-input-example\",on:{\"click\":function($event){return _vm.selectExample(i)}}},[_vm._v(\"\\n                \"+_vm._s(example.name)+\"\\n              \")])})],2),_c('div',{staticClass:\"settings-input-display\",class:{ 'settings-input-display-two-column':\n                            _vm.realSettingsWidth >= 400 }},[_c('div',{staticClass:\"settings-input-raw\"},[_c('label',{attrs:{\"for\":\"input-raw\"}},[_vm._v(\"输入数据：\")]),_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.rawInput),expression:\"rawInput\"}],attrs:{\"id\":\"input-raw\",\"rows\":\"10\"},domProps:{\"value\":(_vm.rawInput)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.rawInput=$event.target.value}}})]),_c('div',{staticClass:\"settings-input-parsed\"},[_c('label',{attrs:{\"for\":\"input-parsed\"}},[_vm._v(\"解析结果（只读）：\")]),_c('textarea',{attrs:{\"id\":\"input-parsed\",\"rows\":\"10\",\"readonly\":\"\"},domProps:{\"value\":_vm.parsedInput}})])])])],1)]):_vm._e()])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h2',{staticClass:\"pane-title\",on:{\"click\":_vm.click}},[_vm._v(\"\\n    \"+_vm._s(_vm.title)+\"\\n    \"),_c('v-icon',{staticClass:\"pane-arrow\",class:{ 'pane-arrow-expand': _vm.expand },attrs:{\"name\":\"angle-up\"}})],1),_c('div',{ref:\"paneContent\",staticClass:\"pane-content\",style:(_vm.animationHeight !== null ?\n               { height: _vm.animationHeight + 'px' } : {})},[_vm._t(\"default\")],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport 'vue-awesome/icons/angle-up';\nimport { Vue, Component, Prop } from 'vue-property-decorator';\n\n@Component\nexport default class CollapsiblePane extends Vue {\n  @Prop(String) public readonly title: string | undefined;\n  private expand = true;\n  private realHeight = 0;\n  private animationHeight: number|null = null;\n  public mounted() {\n    const content = this.$refs.paneContent as HTMLElement;\n    this.realHeight = content.offsetHeight;\n    content.addEventListener('transitionend', this.transitionEnd.bind(this));\n  }\n  public click() {\n    this.expand = !this.expand;\n    if (this.expand) {\n      this.animationHeight = 0;\n      setTimeout(() => {\n        this.animationHeight = this.realHeight;\n      });\n    } else {\n      const content = this.$refs.paneContent as HTMLElement;\n      this.realHeight = content.offsetHeight;\n      this.animationHeight = this.realHeight;\n      setTimeout(() => {\n        this.animationHeight = 0;\n      });\n    }\n  }\n  public transitionEnd() {\n    if (this.animationHeight !== 0) {\n      this.animationHeight = null;\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollapsiblePane.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollapsiblePane.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./CollapsiblePane.vue?vue&type=template&id=08120549&scoped=true&\"\nimport script from \"./CollapsiblePane.vue?vue&type=script&lang=ts&\"\nexport * from \"./CollapsiblePane.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./CollapsiblePane.vue?vue&type=style&index=0&id=08120549&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"08120549\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"graph-container\"},[_c('my-canvas',_vm._g({ref:\"mainCanvas\",attrs:{\"width\":_vm.width,\"height\":_vm.height,\"data\":_vm.mainCanvasData,\"enable-hit\":true},on:{\"mousedown\":_vm.mousedown,\"wheel\":_vm.wheel}},_vm.mouseDragActive ? { mouseup: _vm.mouseup, mousemove: _vm.mousemove } : {})),_c('div',{staticClass:\"thumbnail\",style:({\n    width: _vm.thumbnailWidth + 'px',\n    height: _vm.thumbnailHeight + 'px',\n  })},[_c('my-canvas',_vm._g({ref:\"thumbnailCanvas\",attrs:{\"width\":_vm.thumbnailWidth,\"height\":_vm.thumbnailHeight,\"data\":_vm.thumbnailCanvasData,\"enable-hit\":true},on:{\"mousedown\":_vm.thumbnailMousedown}},_vm.thumbnailMouseDragActive ? {\n                 mouseup: _vm.thumbnailMouseup,\n                 mousemove: _vm.thumbnailMousemove,\n               } : {}))],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default class EventEmitter {\n  private readonly events: { [event: string]: Array<(...args: any[]) => any> } = {};\n\n  public addEventListener(event: string, listener: (...args: any[]) => any) {\n    if (this.events[event] === undefined) {\n      this.events[event] = [];\n    }\n    this.events[event].push(listener);\n  }\n\n  public removeEventListener(event: string, listener: (...args: any[]) => any) {\n    if (this.events[event] !== undefined) {\n      const index = this.events[event].indexOf(listener);\n      if (index > -1) {\n        this.events[event].splice(index, -1);\n      }\n    }\n  }\n\n  public emit(event: string, ...args: any[]) {\n    if (this.events[event] !== undefined) {\n      for (const listener of this.events[event]) {\n        listener.apply(this, args);\n      }\n    }\n  }\n}\n","import Edge from '@/graph/edge/Edge';\nimport {EdgeData} from '@/graph/base/data';\n\nexport default abstract class EdgeType {\n  public readonly parent: Edge;\n  public constructor(parent: Edge) {\n    this.parent = parent;\n  }\n  public abstract setData(data: EdgeData): void;\n  public abstract render(): object;\n}\n","import EdgeType from '@/graph/edge/type/EdgeType';\nimport {StraightEdgeData} from '@/graph/base/data';\n\nexport interface StraightEdgeConfig {\n  fromPointer: boolean;\n  toPointer: boolean;\n  lineColor: string;\n  lineWidth: number;\n  pointerColor: string;\n  pointerWidth: number;\n  pointerHeight: number;\n}\n\nexport default class StraightEdgeType extends EdgeType {\n  private static defaultConfig: StraightEdgeConfig = {\n    fromPointer: false,\n    toPointer: true,\n    lineColor: 'black',\n    lineWidth: 1,\n    pointerColor: 'black',\n    pointerWidth: 10,\n    pointerHeight: 15,\n  };\n  private config?: StraightEdgeConfig;\n  public setData(data: StraightEdgeData): void {\n    this.config = Object.assign({}, StraightEdgeType.defaultConfig, data);\n  }\n  public render(): object {\n    if (!this.parent.graph) {\n      throw new Error('Top level edge cannot be rendered');\n    }\n    const fromNode = this.parent.graph.findPort(this.parent.from!.split(':'));\n    const toNode = this.parent.graph.findPort(this.parent.to!.split(':'));\n    if (!fromNode || !toNode) {\n      throw new Error('Unknown start or end node for edge');\n    }\n    const fromPos = fromNode.getAbsolutePosition(this.parent.parent!);\n    const toPos = toNode.getAbsolutePosition(this.parent.parent!);\n    const fromAngle = Math.atan2(toPos.y - fromPos.y, toPos.x - fromPos.x);\n    const toAngle = Math.PI + fromAngle;\n    const fromDistance = fromNode.distanceToBorder(fromAngle);\n    const toDistance = toNode.distanceToBorder(toAngle);\n    let realFromPosX = fromPos.x + fromDistance * Math.cos(fromAngle);\n    let realFromPosY = fromPos.y + fromDistance * Math.sin(fromAngle);\n    let realToPosX = toPos.x + toDistance * Math.cos(toAngle);\n    let realToPosY = toPos.y + toDistance * Math.sin(toAngle);\n    const children: object[] = [];\n    if (this.config!.fromPointer) {\n      children.push({\n        is: 'MyPointer',\n        key: 'toPointer',\n        x: realFromPosX,\n        y: realFromPosY,\n        angle: fromAngle,\n        width: this.config!.pointerWidth,\n        height: this.config!.pointerHeight,\n        fill: this.config!.pointerColor,\n      });\n      realFromPosX += this.config!.pointerWidth * Math.cos(fromAngle);\n      realFromPosY += this.config!.pointerWidth * Math.sin(fromAngle);\n    }\n    if (this.config!.toPointer) {\n      children.push({\n        is: 'MyPointer',\n        key: 'toPointer',\n        x: realToPosX,\n        y: realToPosY,\n        angle: toAngle,\n        width: this.config!.pointerWidth,\n        height: this.config!.pointerHeight,\n        fill: this.config!.pointerColor,\n      });\n      realToPosX += this.config!.pointerWidth * Math.cos(toAngle);\n      realToPosY += this.config!.pointerWidth * Math.sin(toAngle);\n    }\n    children.unshift({\n      is: 'MyLine',\n      key: 'line',\n      points: [\n        realFromPosX, realFromPosY, realToPosX, realToPosY,\n      ],\n      stroke: this.config!.lineColor,\n      strokeWidth: this.config!.lineWidth,\n    });\n    return {\n      is: 'MyGroup',\n      key: this.parent.id,\n      children,\n    };\n  }\n}\n","import {Position} from '@/graph/base/data';\n\nexport default class Positioned {\n  public parent: Positioned | null;\n  protected position: Position;\n  public constructor(parent: Positioned | null) {\n    this.parent = parent;\n    this.position = { x: 0, y: 0 };\n  }\n  public setPosition(position: Position): void {\n    this.position = position;\n  }\n  public getPosition(): Position {\n    return this.position;\n  }\n  public getAbsolutePosition(parent: Positioned): Position {\n    let x = 0;\n    let y = 0;\n    let node: Positioned | null = this;\n    while (node !== parent) {\n      if (node === null) {\n        throw new Error('Incorrect parent parameter');\n      }\n      x += node.position.x;\n      y += node.position.y;\n      node = node.parent;\n    }\n    return {x, y};\n  }\n}\n","import EdgeType from '@/graph/edge/type/EdgeType';\nimport {QuadraticEdgeData} from '@/graph/base/data';\nimport Positioned from '@/graph/base/Positioned';\n\nexport interface QuadraticEdgeConfig {\n  fromPointer: boolean;\n  toPointer: boolean;\n  lineColor: string;\n  lineWidth: number;\n  pointerColor: string;\n  pointerWidth: number;\n  pointerHeight: number;\n}\n\nexport default class QuadraticEdgeType extends EdgeType {\n  private static defaultConfig: QuadraticEdgeConfig = {\n    fromPointer: false,\n    toPointer: true,\n    lineColor: 'black',\n    lineWidth: 1,\n    pointerColor: 'black',\n    pointerWidth: 10,\n    pointerHeight: 15,\n  };\n  private config?: QuadraticEdgeConfig;\n  private controlPoint?: Positioned;\n  public setData(data: QuadraticEdgeData): void {\n    this.config = Object.assign({}, QuadraticEdgeType.defaultConfig, data);\n  }\n  public render(): object {\n    if (!this.parent.graph) {\n      throw new Error('Top level edge cannot be rendered');\n    }\n    const fromNode = this.parent.graph.findPort(this.parent.from!.split(':'));\n    const toNode = this.parent.graph.findPort(this.parent.to!.split(':'));\n    if (!fromNode || !toNode) {\n      throw new Error('Unknown start or end node for edge');\n    }\n    if (!this.controlPoint) {\n      this.controlPoint = new Positioned(this.parent.parent);\n      this.controlPoint.setPosition({\n        x: 0.5 * (fromNode.getPosition().x + toNode.getPosition().x),\n        y: 0.5 * (fromNode.getPosition().y + toNode.getPosition().y),\n      });\n    }\n    const fromPos = fromNode.getAbsolutePosition(this.parent.parent!);\n    const toPos = toNode.getAbsolutePosition(this.parent.parent!);\n    const viaPos = this.controlPoint.getPosition();\n    const fromAngle = Math.atan2(viaPos.y - fromPos.y, viaPos.x - fromPos.x);\n    const toAngle = Math.PI + Math.atan2(toPos.y - viaPos.y, toPos.x - viaPos.x);\n    const fromDistance = fromNode.distanceToBorder(fromAngle);\n    const toDistance = toNode.distanceToBorder(toAngle);\n    let realFromPosX = fromPos.x + fromDistance * Math.cos(fromAngle);\n    let realFromPosY = fromPos.y + fromDistance * Math.sin(fromAngle);\n    let realToPosX = toPos.x + toDistance * Math.cos(toAngle);\n    let realToPosY = toPos.y + toDistance * Math.sin(toAngle);\n    const children: object[] = [];\n    if (this.config!.fromPointer) {\n      children.push({\n        is: 'MyPointer',\n        key: 'toPointer',\n        x: realFromPosX,\n        y: realFromPosY,\n        angle: fromAngle,\n        width: this.config!.pointerWidth,\n        height: this.config!.pointerHeight,\n        fill: this.config!.pointerColor,\n      });\n      realFromPosX += this.config!.pointerWidth * Math.cos(fromAngle);\n      realFromPosY += this.config!.pointerWidth * Math.sin(fromAngle);\n    }\n    if (this.config!.toPointer) {\n      children.push({\n        is: 'MyPointer',\n        key: 'toPointer',\n        x: realToPosX,\n        y: realToPosY,\n        angle: toAngle,\n        width: this.config!.pointerWidth,\n        height: this.config!.pointerHeight,\n        fill: this.config!.pointerColor,\n      });\n      realToPosX += this.config!.pointerWidth * Math.cos(toAngle);\n      realToPosY += this.config!.pointerWidth * Math.sin(toAngle);\n    }\n    children.unshift({\n      is: 'MyQuadraticLine',\n      key: 'line',\n      points: [\n        realFromPosX, realFromPosY,\n        this.controlPoint.getPosition().x,\n        this.controlPoint.getPosition().y,\n        realToPosX, realToPosY,\n      ],\n      stroke: this.config!.lineColor,\n      strokeWidth: this.config!.lineWidth,\n    });\n    return {\n      is: 'MyGroup',\n      key: this.parent.id,\n      children,\n    };\n  }\n}\n","import {EdgeData} from '@/graph/base/data';\nimport Edge from '@/graph/edge/Edge';\nimport StraightEdgeType from '@/graph/edge/type/StraightEdgeType';\nimport EdgeType from '@/graph/edge/type/EdgeType';\nimport QuadraticEdgeType from '@/graph/edge/type/QuadraticEdgeType';\n\nexport default function edgeTypeFactory(data: EdgeData)\n    : new (parent: Edge) => EdgeType {\n  switch (data.shape) {\n    case 'straight':\n      return StraightEdgeType;\n    default:\n      return QuadraticEdgeType;\n  }\n}\n","import {EdgeData} from '@/graph/base/data';\nimport Root from '@/graph/Root';\nimport Renderable from '@/graph/base/Renderable';\nimport Positioned from '@/graph/base/Positioned';\nimport Graph from '@/graph/graph/Graph';\nimport EdgeType from '@/graph/edge/type/EdgeType';\nimport edgeTypeFactory from '@/graph/edge/type';\n\nexport default class Edge implements Renderable {\n  public static getId(data: EdgeData) {\n    return data.id || `${data.from}-${data.to}`;\n  }\n  public from?: string;\n  public to?: string;\n  public fullId?: string;\n  public readonly root: Root;\n  public readonly graph: Graph | null;\n  public readonly parent: Positioned | null;\n  public id?: string;\n  private edgeType?: EdgeType;\n  constructor(root: Root, graph: Graph | null, parent: Positioned | null) {\n    this.root = root;\n    this.graph = graph;\n    this.parent = parent;\n  }\n  public setData(data: EdgeData) {\n    this.id = Edge.getId(data);\n    this.from = data.from;\n    this.to = data.to;\n    this.fullId = data.parentId ? `${data.parentId}:${this.id}` : this.id;\n    const typeClass = edgeTypeFactory(data);\n    if (!this.edgeType || this.edgeType.constructor !== typeClass) {\n      this.edgeType = new typeClass(this);\n    }\n    this.edgeType.setData(data);\n  }\n  public render() {\n    return this.edgeType!.render();\n  }\n}\n","import Graph from '@/graph/graph/Graph';\nimport Positioned from '@/graph/base/Positioned';\nimport {GraphLayoutData, Size} from '@/graph/base/data';\nimport Port from '@/graph/base/Port';\nimport Edge from '@/graph/edge/Edge';\nimport Renderable from '@/graph/base/Renderable';\n\nexport interface LayoutEdgeData {\n  from: Port;\n  to: Port;\n  fromBelonging: Port;\n  toBelonging: Port;\n  edge: Edge;\n}\n\nexport interface LayoutData {\n  ports: Port[];\n  edges: LayoutEdgeData[];\n  children: Renderable[];\n}\n\nexport default abstract class GraphLayout extends Positioned {\n  protected readonly graph: Graph;\n  protected constructor(graph: Graph, parent: Positioned | null) {\n    super(parent);\n    this.graph = graph;\n  }\n  public abstract solve(config: GraphLayoutData | undefined,\n                        data: LayoutData,\n                        index: number): void;\n  public abstract render(): object;\n  public abstract getContentSize(): Size | undefined;\n}\n","import Graph from '@/graph/graph/Graph';\nimport GraphLayout, {LayoutData} from '@/graph/graph/layout/GraphLayout';\nimport {KamadaKawaiGraphLayoutData, Size} from '@/graph/base/data';\nimport Port from '@/graph/base/Port';\nimport Positioned from '@/graph/base/Positioned';\n\ninterface KamadaKawaiGraphLayoutConfig {\n  springLength: number;\n  springConstant: number;\n}\n\nexport default class KamadaKawaiGraphLayout extends GraphLayout {\n  private static defaultConfig: KamadaKawaiGraphLayoutConfig = {\n    springLength: 150,\n    springConstant: 0.05,\n  };\n  private data?: LayoutData;\n  private index?: number;\n  private contentSize?: Size;\n  constructor(graph: Graph, parent: Positioned | null) {\n    super(graph, parent);\n  }\n  public solve(config: KamadaKawaiGraphLayoutData | undefined,\n               data: LayoutData,\n               index: number) {\n    const newConfig: KamadaKawaiGraphLayoutConfig = Object.assign({},\n      KamadaKawaiGraphLayout.defaultConfig, config);\n    this.data = data;\n    this.index = index;\n    const portToIndex: Map<Port, number> = new Map();\n    for (let i = 0; i < data.ports.length; ++i) {\n      portToIndex.set(data.ports[i], i);\n    }\n    // Initial random placement\n    for (const port of data.ports) {\n      if (!port.initialPlaced) {\n        port.setPosition({\n          x: newConfig.springLength * ( Math.random() - 0.5),\n          y: newConfig.springLength * ( Math.random() - 0.5),\n        });\n        port.initialPlaced = true;\n      }\n    }\n      // Compute distance matrix by Floyd Warshall\n    const distanceMatrix: number[][] = [];\n    for (let i = 0; i < data.ports.length; ++i) {\n      distanceMatrix.push(Array(data.ports.length).fill(Infinity));\n      distanceMatrix[distanceMatrix.length - 1][i] = 0;\n    }\n    for (const {fromBelonging, toBelonging} of data.edges) {\n      const fromIndex = portToIndex.get(fromBelonging)!;\n      const toIndex = portToIndex.get(toBelonging)!;\n      distanceMatrix[fromIndex][toIndex] = 1;\n      distanceMatrix[toIndex][fromIndex] = 1;\n    }\n    for (let k = 0; k < data.ports.length; ++k) {\n      for (let i = 0; i < data.ports.length; ++i) {\n        for (let j = 0; j < data.ports.length; ++j) {\n          const dist = distanceMatrix[i][k] + distanceMatrix[k][j];\n          if (distanceMatrix[i][j] > dist) {\n            distanceMatrix[i][j] = dist;\n          }\n        }\n      }\n    }\n    // Place ports using Kamada Kawai\n    // Compute length matrix\n    const lengthMatrix = [];\n    for (let i = 0; i < data.ports.length; ++i) {\n      const length = [];\n      for (let j = 0; j < data.ports.length; ++j) {\n        length.push(newConfig.springLength * distanceMatrix[i][j]);\n      }\n      lengthMatrix.push(length);\n    }\n    // Compute k matrix\n    const kMatrix = [];\n    for (let i = 0; i < data.ports.length; ++i) {\n      const k = [];\n      for (let j = 0; j < data.ports.length; ++j) {\n        k.push(newConfig.springConstant *\n          Math.pow(distanceMatrix[i][j], -2));\n      }\n      kMatrix.push(k);\n    }\n    // Compute energy matrix\n    const energyMatrix = [];\n    for (const port of data.ports) {\n      energyMatrix.push(Array(data.ports.length));\n    }\n    for (let m = 0; m < data.ports.length; ++m) {\n      const mPos = data.ports[m].getPosition();\n      energyMatrix[m][m] = [0, 0];\n      for (let i = m + 1; i < data.ports.length; ++i) {\n        const iPos = data.ports[i].getPosition();\n        const denominator = 1.0 / Math.sqrt(\n          Math.pow(mPos.x - iPos.x, 2) + Math.pow(mPos.y - iPos.y, 2));\n        energyMatrix[m][i] = [\n          kMatrix[m][i] * (mPos.x - iPos.x) *\n            (1 - lengthMatrix[m][i] * denominator),\n          kMatrix[m][i] * (mPos.y - iPos.y) *\n            (1 - lengthMatrix[m][i] * denominator),\n        ];\n        energyMatrix[i][m] = [\n          -energyMatrix[m][i][0],\n          -energyMatrix[m][i][1],\n        ];\n      }\n    }\n    const energySum = [];\n    for (let i = 0; i < data.ports.length; ++i) {\n      const sum = [0, 0];\n      for (let j = 0; j < data.ports.length; ++j) {\n        sum[0] += energyMatrix[i][j][0];\n        sum[1] += energyMatrix[i][j][1];\n      }\n      energySum.push(sum);\n    }\n    // Compute position\n    const threshold = 0.01;\n    const maxIterations = Math.max(1000,\n      Math.min(10 * data.ports.length, 6000));\n    const maxInnerIterations = 5;\n    let iterations = 0;\n    let maxEnergy;\n    while (iterations < maxIterations) {\n      iterations += 1;\n      // Get port with highest energy\n      let m = 0;\n      let deDx = 0;\n      let deDy = 0;\n      maxEnergy = -1;\n      for (let i = 0; i < data.ports.length; ++i) {\n        const e = Math.sqrt(Math.pow(energySum[i][0], 2) +\n          Math.pow(energySum[i][1], 2));\n        if (e > maxEnergy) {\n          m = i;\n          deDx = energySum[i][0];\n          deDy = energySum[i][1];\n          maxEnergy = e;\n        }\n      }\n      if (maxEnergy <= threshold) {\n        break;\n      }\n      const mPos = data.ports[m].getPosition();\n      let delta = maxEnergy;\n      let subIterations = 0;\n      while (delta > threshold && subIterations < maxInnerIterations) {\n        subIterations += 1;\n        // Move port\n        let d2eDx2 = 0;\n        let d2eDxDy = 0;\n        let d2eDy2 = 0;\n        for (let i = 0; i < data.ports.length; ++i) {\n          if (i !== m) {\n            const iPos = data.ports[i].getPosition();\n            const factor = 1.0 / Math.pow(Math.pow(mPos.x - iPos.x, 2) +\n              Math.pow(mPos.y - iPos.y, 2), 1.5);\n            const k = kMatrix[m][i];\n            const l = lengthMatrix[m][i];\n            d2eDx2 += k * (1 - l * Math.pow(mPos.y - iPos.y, 2) * factor);\n            d2eDxDy += k * l * (mPos.x - iPos.x) * (mPos.y - iPos.y) *\n              factor;\n            d2eDy2 += k * (1 - l * Math.pow(mPos.x - iPos.x, 2) * factor);\n          }\n        }\n        // Solve equation using Cramer's rule\n        const denominator = d2eDx2 * d2eDy2 - Math.pow(d2eDxDy, 2);\n        const dx = (d2eDxDy * deDy - d2eDy2 * deDx) / denominator;\n        const dy = (d2eDxDy * deDx - d2eDx2 * deDy) / denominator;\n        mPos.x += dx;\n        mPos.y += dy;\n        // Recalculate energy matrix\n        let sumX = 0;\n        let sumY = 0;\n        for (let i = 0; i < data.ports.length; ++i) {\n          if (i !== m) {\n            const [oldDx, oldDy] = energyMatrix[m][i];\n            const iPos = data.ports[i].getPosition();\n            const factor = 1.0 / Math.sqrt(\n              Math.pow(mPos.x - iPos.x, 2) + Math.pow(mPos.y - iPos.y, 2));\n            const deltaX = kMatrix[m][i] * (mPos.x - iPos.x) *\n              (1 - lengthMatrix[m][i] * factor);\n            const deltaY = kMatrix[m][i] * (mPos.y - iPos.y) *\n              (1 - lengthMatrix[m][i] * factor);\n            energyMatrix[m][i] = [deltaX, deltaY];\n            energyMatrix[i][m] = [-deltaX, -deltaY];\n            energySum[i][0] += oldDx - deltaX;\n            energySum[i][1] += oldDy - deltaY;\n            sumX += deltaX;\n            sumY += deltaY;\n          }\n        }\n        energySum[m] = [sumX, sumY];\n        // Update\n        delta = Math.sqrt(Math.pow(energySum[m][0], 2) +\n          Math.pow(energySum[m][1], 2));\n        deDx = energySum[m][0];\n        deDy = energySum[m][1];\n      } // for kamada kawai inner iteration\n    } // for kamada kawai outer iteration\n    // Save results for further evaluation\n    // Calculate component size and position\n    const upperLeft = [Infinity, Infinity];\n    const lowerRight = [-Infinity, -Infinity];\n    for (const port of data.ports) {\n      const pos = port.getPosition();\n      const size = port.getBoundingBoxSize();\n      const halfWidth = size.width / 2;\n      const halfHeight = size.height / 2;\n      if (pos.x - halfWidth < upperLeft[0]) {\n        upperLeft[0] = pos.x - halfWidth;\n      }\n      if (pos.x + halfWidth > lowerRight[0]) {\n        lowerRight[0] = pos.x + halfWidth;\n      }\n      if (pos.y - halfHeight < upperLeft[1]) {\n        upperLeft[1] = pos.y - halfHeight;\n      }\n      if (pos.y + halfHeight > lowerRight[1]) {\n        lowerRight[1] = pos.y + halfHeight;\n      }\n    }\n    const position = {\n      x: (upperLeft[0] + lowerRight[0]) / 2,\n      y: (upperLeft[1] + lowerRight[1]) / 2,\n    };\n    this.contentSize = {\n      width: lowerRight[0] - upperLeft[0],\n      height: lowerRight[1] - upperLeft[1],\n    };\n    // Move ports to center\n    for (const port of data.ports) {\n      port.getPosition().x -= position.x;\n      port.getPosition().y -= position.y;\n    }\n  } // solve method\n  public render() {\n    return {\n      is: 'MyGroup',\n      key: `component-${this.index}`,\n      x: this.position.x,\n      y: this.position.y,\n      children: this.data!.children.map((x) => x.render()),\n    };\n  }\n  public getContentSize() {\n    return this.contentSize;\n  }\n}\n","import KamadaKawaiGraphLayout from './KamadaKawaiGraphLayout';\nimport {GraphLayoutData} from '@/graph/base/data';\nimport GraphLayout from '@/graph/graph/layout/GraphLayout';\nimport Graph from '@/graph/graph/Graph';\nimport Positioned from '@/graph/base/Positioned';\n\nexport default function layoutFactory(data: GraphLayoutData | undefined)\n    : new (graph: Graph, parent: Positioned | null) => GraphLayout {\n  switch (data && data.type) {\n    default:\n      return KamadaKawaiGraphLayout;\n  }\n}\n","import Graph from '@/graph/graph/Graph';\nimport Positioned from '@/graph/base/Positioned';\nimport {ComponentLayoutData, Size} from '@/graph/base/data';\n\nexport default abstract class ComponentLayout extends Positioned {\n  protected readonly graph: Graph;\n  protected constructor(graph: Graph, parent: Positioned | null) {\n    super(parent);\n    this.graph = graph;\n  }\n  public abstract solve(config: ComponentLayoutData | undefined): void;\n  public abstract render(): object;\n  public abstract getContentSize(): Size | undefined;\n}\n","import ComponentLayout from '@/graph/graph/component/ComponentLayout';\nimport Graph from '@/graph/graph/Graph';\nimport {LinearComponentLayoutData, Size} from '@/graph/base/data';\nimport Positioned from '@/graph/base/Positioned';\n\ninterface LinearComponentLayoutConfig {\n  direction: 'TD' | 'DT' | 'LR' | 'RL';\n  spaceBetween: number;\n}\n\nexport default class LinearComponentLayout extends ComponentLayout {\n  private static defaultConfig = {\n    direction: 'TD',\n    spaceBetween: 12,\n  };\n  private contentSize?: Size;\n  constructor(graph: Graph, parent: Positioned | null) {\n    super(graph, parent);\n  }\n  public solve(config: LinearComponentLayoutData | undefined) {\n    const newConfig: LinearComponentLayoutConfig = Object.assign({},\n      LinearComponentLayout.defaultConfig, config);\n    const components = this.graph.layouts!;\n    const componentsSize = components.map((x) => x.getContentSize()!);\n    if (newConfig.direction === 'LR' || newConfig.direction === 'RL') {\n      this.contentSize = {\n        width: componentsSize.map((x) => x.width).reduce((a, b) => a + b, 0) +\n          Math.max(components.length - 1, 0) * newConfig.spaceBetween,\n        height: Math.max(...componentsSize.map((x) => x.height), 0),\n      };\n      let begin = newConfig.direction === 'LR' ?\n        -this.contentSize.width / 2 : this.contentSize.width / 2;\n      for (let i = 0; i < components.length; ++i) {\n        const deltaX = (newConfig.direction === 'LR' ?\n          componentsSize[i].width / 2 : -componentsSize[i].width / 2) +\n          begin;\n        components[i].setPosition({ x: deltaX, y: 0 });\n        if (newConfig.direction === 'LR') {\n          begin += componentsSize[i].width + newConfig.spaceBetween;\n        } else {\n          begin -= componentsSize[i].width + newConfig.spaceBetween;\n        }\n      }\n    } else {\n      this.contentSize = {\n        width: Math.max(...componentsSize.map((x) => x.width), 0),\n        height: componentsSize.map((x) => x.height).reduce((a, b) => a + b, 0) +\n          Math.max(components.length - 1, 0) * newConfig.spaceBetween,\n      };\n      let begin = newConfig.direction === 'DT' ?\n        this.contentSize.height / 2 : -this.contentSize.height / 2;\n      for (let i = 0; i < components.length; ++i) {\n        const deltaY = (newConfig.direction === 'DT' ?\n          -componentsSize[i].height / 2 : componentsSize[i].height / 2) +\n          begin;\n        components[i].setPosition({ x: 0, y: deltaY });\n        if (newConfig.direction === 'DT') {\n          begin -= componentsSize[i].height + newConfig.spaceBetween;\n        } else {\n          begin += componentsSize[i].height + newConfig.spaceBetween;\n        }\n      }\n    } // position calculation\n  }\n  public render() {\n    return {\n      is: 'MyGroup',\n      key: `components`,\n      x: this.position.x,\n      y: this.position.y,\n      children: this.graph.layouts!.map((x) => x.render()),\n    };\n  }\n  public getContentSize() {\n    return this.contentSize;\n  }\n}\n","import {ComponentLayoutData} from '@/graph/base/data';\nimport Graph from '@/graph/graph/Graph';\nimport ComponentLayout from '@/graph/graph/component/ComponentLayout';\nimport LinearComponentLayout from '@/graph/graph/component/LinearComponentLayout';\nimport Positioned from '@/graph/base/Positioned';\n\nexport default function componentFactory(data: ComponentLayoutData | undefined)\n  : new (graph: Graph, parent: Positioned | null) => ComponentLayout {\n  switch (data && data.type) {\n    default:\n      return LinearComponentLayout;\n  }\n}\n","import Graph from '@/graph/graph/Graph';\nimport {GraphData, Size} from '@/graph/base/data';\n\nexport default abstract class GraphType {\n  protected parent: Graph;\n  protected constructor(parent: Graph) {\n    this.parent = parent;\n  }\n  public abstract setData(data: GraphData): void;\n  public abstract render(): object[];\n  public abstract getBoundingBoxSize(): Size;\n  public abstract distanceToBorder(angle: number): number;\n}\n","import GraphType from '@/graph/graph/type/GraphType';\nimport Graph from '@/graph/graph/Graph';\nimport {BoxGraphData, Position, Size} from '@/graph/base/data';\n\ninterface BoxGraphConfig {\n  label: string | null;\n  labelPosition: 'top' | 'right' | 'bottom' | 'left';\n  style: 'solid' | 'filled' | 'none';\n  fillColor: string;\n  strokeColor: string;\n  strokeWidth: number;\n  fontSize: number;\n  fontFamily: string;\n  lineHeight: number;\n  padding: number;\n  align: 'left' | 'center' | 'right';\n  spaceBetween: number;\n}\n\nexport default class BoxGraphType extends GraphType {\n  public static defaultConfig = {\n    label: null,\n    labelPosition: 'top', // or 'right', 'bottom', 'left'\n    style: 'none',  // or 'filled'\n    fillColor: 'white',\n    strokeColor: 'black',\n    strokeWidth: 0,\n    fontSize: 12,\n    fontFamily: 'sans-serif',\n    lineHeight: 1.2,\n    padding: 6,\n    align: 'center',\n    spaceBetween: 12,\n  };\n  private config?: BoxGraphConfig;\n  private textSize?: Size;\n  private contentSize?: Size;\n  private textPosition?: Position;\n  private borderSize?: Size;\n  constructor(parent: Graph) {\n    super(parent);\n  }\n  public setData(data: BoxGraphData) {\n    const newConfig = Object.assign({}, BoxGraphType.defaultConfig, data);\n    delete newConfig.layout;\n    delete newConfig.children;\n    const textSizeNeedsUpdate = !this.config ||\n      this.config.label !== newConfig.label ||\n      this.config.fontSize !== newConfig.fontSize ||\n      this.config.fontFamily !== newConfig.fontFamily ||\n      this.config.lineHeight !== newConfig.lineHeight;\n    if (textSizeNeedsUpdate) {\n      const ctx = this.parent.root.ctx;\n      ctx.font = `${newConfig.fontSize}px ${newConfig.fontFamily}`;\n      const lines = newConfig.label ? (newConfig.label as string)\n        .split('\\n') : [];\n      this.textSize = {\n        width: Math.max(...lines.map((x) => ctx.measureText(x).width), 0),\n        height: lines.length * newConfig.fontSize * newConfig.lineHeight,\n      };\n    }\n    const layoutContentSize = this.parent.componentLayout!.getContentSize()!;\n    this.contentSize = {\n      width: layoutContentSize.width + 2 * newConfig.padding,\n      height: layoutContentSize.height + 2 * newConfig.padding,\n    };\n    this.parent.componentLayout!.setPosition({ x: 0, y: 0 });\n    this.textPosition = { x: 0, y: 0 };\n    if (newConfig.label) {\n      if (newConfig.labelPosition === 'left' ||\n          newConfig.labelPosition === 'right') {\n        this.contentSize.width += this.textSize!.width + newConfig.spaceBetween;\n        if (this.textSize!.height > layoutContentSize.height) {\n          this.contentSize.height = this.textSize!.height +\n            2 * newConfig.padding;\n        }\n        if (newConfig.labelPosition === 'left') {\n          this.parent.componentLayout!.getPosition().x = (this.textSize!.width +\n            newConfig.spaceBetween) / 2;\n          this.textPosition.x = -(layoutContentSize.width +\n            newConfig.spaceBetween) / 2;\n        } else {\n          this.parent.componentLayout!.getPosition().x = -(this.textSize!.width +\n            newConfig.spaceBetween) / 2;\n          this.textPosition.x = (layoutContentSize.width +\n            newConfig.spaceBetween) / 2;\n        }\n      } else {\n        this.contentSize.height += this.textSize!.height +\n          newConfig.spaceBetween;\n        if (this.textSize!.width > layoutContentSize.width) {\n          this.contentSize.width = this.textSize!.width + 2 * newConfig.padding;\n        }\n        if (newConfig.labelPosition === 'bottom') {\n          this.parent.componentLayout!.getPosition().y = -(this.textSize!.height +\n            newConfig.spaceBetween) / 2;\n          this.textPosition.y = (layoutContentSize.height +\n            newConfig.spaceBetween) / 2;\n        } else {\n          this.parent.componentLayout!.getPosition().y = (this.textSize!.height +\n            newConfig.spaceBetween) / 2;\n          this.textPosition.y = -(layoutContentSize.height +\n            newConfig.spaceBetween) / 2;\n        }\n      }\n    }\n    this.borderSize = {\n      width: this.contentSize.width + newConfig.strokeWidth,\n      height: this.contentSize.height + newConfig.strokeWidth,\n    };\n    this.config = newConfig;\n  }\n  public render() {\n    const rendered: object[] = [];\n    if (this.config!.style && this.config!.style !== 'none') {\n      const rect = {\n        is: 'MyRect',\n        key: 'rect',\n        x: -this.contentSize!.width / 2,\n        y: -this.contentSize!.height / 2,\n        width: this.contentSize!.width,\n        height: this.contentSize!.height,\n        fill: this.config!.style === 'filled' ?\n          this.config!.fillColor : undefined,\n        stroke: this.config!.strokeWidth > 0 ?\n          this.config!.strokeColor : undefined,\n        strokeWidth: this.config!.strokeWidth,\n      };\n      rendered.push(rect);\n    }\n    if (this.config!.label) {\n      const text = {\n        is: 'MyText',\n        key: 'text',\n        x: this.textPosition!.x - this.textSize!.width / 2,\n        y: this.textPosition!.y - this.textSize!.height / 2,\n        text: this.config!.label,\n        fontSize: this.config!.fontSize,\n        fontFamily: this.config!.fontFamily,\n        lineHeight: this.config!.lineHeight,\n        align: this.config!.align,\n      };\n      rendered.push(text);\n    }\n    rendered.push(this.parent.componentLayout!.render());\n    return rendered;\n  }\n  public getBoundingBoxSize() {\n    return this.borderSize!;\n  }\n  public distanceToBorder(angle: number) {\n    return Math.min(\n      Math.abs(this.borderSize!.width / 2 / Math.cos(angle)),\n      Math.abs(this.borderSize!.height / 2 / Math.sin(angle)),\n    );\n  }\n}\n","import BoxGraphType from '@/graph/graph/type/BoxGraphType';\nimport GraphType from '@/graph/graph/type/GraphType';\nimport Graph from '@/graph/graph/Graph';\nimport {GraphData} from '@/graph/base/data';\n\n// noinspection JSUnusedLocalSymbols\nexport default function graphTypeFactory(data: GraphData)\n    : new (parent: Graph) => GraphType {\n  return BoxGraphType;\n}\n","import Positioned from '@/graph/base/Positioned';\nimport {Size} from '@/graph/base/data';\nimport Root from '@/graph/Root';\n\nexport default abstract class Port extends Positioned {\n  public readonly root: Root;\n  public initialPlaced: boolean; // for graph layout\n  public id: string;\n  protected constructor(root: Root, parent: Positioned | null = null) {\n    super(parent);\n    this.root = root;\n    this.initialPlaced = false;\n    this.id = '';\n  }\n  public findPort(id: string[]): Port | null {\n    if (id.length === 0) {\n      return this;\n    }\n    return null;\n  }\n  public abstract getBoundingBoxSize(): Size;\n  public abstract distanceToBorder(angle: number): number;\n}\n","import Graph from '@/graph/graph/Graph';\nimport {GraphPhysicsData} from '@/graph/base/data';\nimport GraphLayout, {LayoutData} from '@/graph/graph/layout/GraphLayout';\n\nexport default abstract class GraphPhysics {\n  protected readonly graph: Graph;\n  protected readonly layout: GraphLayout;\n  public constructor(graph: Graph, layout: GraphLayout) {\n    this.graph = graph;\n    this.layout = layout;\n  }\n  public abstract solve(config: GraphPhysicsData | undefined,\n                        data: LayoutData): void;\n  public abstract step(): boolean;\n}\n","import GraphPhysics from '@/graph/graph/physics/GraphPhysics';\nimport {BarnesHutGraphPhysicsData} from '@/graph/base/data';\nimport {LayoutData} from '@/graph/graph/layout/GraphLayout';\n\ninterface BarnesHutGraphPhysicsConfig {\n  theta: number;\n  gravitationalConstant: number;\n  centralGravity: number;\n  springLength: number;\n  springConstant: number;\n}\n\nexport default class BarnesHutGraphPhysics extends GraphPhysics {\n  private static defaultConfig: BarnesHutGraphPhysicsConfig = {\n    theta: 0.5,\n    gravitationalConstant: -2000,\n    centralGravity: 0.3,\n    springLength: 95,\n    springConstant: 0.04,\n  };\n  private config?: BarnesHutGraphPhysicsConfig;\n  private layoutData?: LayoutData;\n  public solve(config: BarnesHutGraphPhysicsData | undefined,\n               data: LayoutData) {\n    this.config = Object.assign({},\n      BarnesHutGraphPhysics.defaultConfig, config);\n    this.layoutData = data;\n  }\n  public step(): boolean {\n    return false;\n  }\n}\n","import {GraphPhysicsData} from '@/graph/base/data';\nimport Graph from '@/graph/graph/Graph';\nimport GraphPhysics from '@/graph/graph/physics/GraphPhysics';\nimport BarnesHutGraphPhysics from '@/graph/graph/physics/BarnesHutGraphPhysics';\nimport GraphLayout from '@/graph/graph/layout/GraphLayout';\n\nexport default function physicsFactory(data: GraphPhysicsData | undefined)\n    : new (graph: Graph, layout: GraphLayout) => GraphPhysics {\n  switch (data && data.type) {\n    default:\n      return BarnesHutGraphPhysics;\n  }\n}\n","/*\n * recordLabel\n *   : field ('|' field )*\n *   ;\n * field\n *   : (’<’ string ’>’)? string?\n *   | '{' recordLabel '}'\n *   ;\n */\n\nenum TokenEnum {\n  EOF,\n  VERTICAL_BAR,\n  LEFT_CURLY_BRACE,\n  RIGHT_CURLY_BRACE,\n  LEFT_ANGLE_BRACE,\n  RIGHT_ANGLE_BRACE,\n  STRING,\n}\n\ninterface Token {\n  type: TokenEnum;\n  text?: string;\n}\n\nexport interface Record {\n  type: 'record';\n  children: RecordData[];\n}\n\nexport interface Field {\n  type: 'field';\n  port?: string;\n  text?: string;\n}\n\nexport type RecordData = Record | Field;\n\nexport default function recordParser(record: string): RecordData {\n  let position = 0;\n  const buffer: Token[] = [];\n  function lexer(): Token {\n    if (buffer.length) {\n      return buffer.pop()!;\n    }\n    while (position < record.length &&\n           ' \\t\\n\\r\\v'.indexOf(record[position]) > -1) {\n      ++position;\n    }\n    if (position >= record.length) {\n      return { type: TokenEnum.EOF };\n    }\n    switch (record[position]) {\n      case '|':\n        ++position;\n        return { type: TokenEnum.VERTICAL_BAR };\n      case '{':\n        ++position;\n        return { type: TokenEnum.LEFT_CURLY_BRACE };\n      case '}':\n        ++position;\n        return { type: TokenEnum.RIGHT_CURLY_BRACE };\n      case '<':\n        ++position;\n        return { type: TokenEnum.LEFT_ANGLE_BRACE };\n      case '>':\n        ++position;\n        return { type: TokenEnum.RIGHT_ANGLE_BRACE };\n      default: {\n        let text = '';\n        while (position < record.length &&\n               ' \\t\\n\\r\\v|{}<>'.indexOf(record[position]) === -1) {\n          if (record[position] === '\\\\') {\n            ++position;\n            if (position === record.length) {\n              throw new Error('Unexpected end of escape sequence');\n            }\n            switch (record[position]) {\n              case 'n':\n                text += '\\n';\n                break;\n              default:\n                text += record[position];\n            }\n          } else {\n            text += record[position];\n          }\n          ++position;\n        }\n        return { type: TokenEnum.STRING, text };\n      }\n    }\n  }\n  function parseRecordLabel(): Record {\n    const children = [parseField()];\n    let token;\n    while ((token = lexer())!.type === TokenEnum.VERTICAL_BAR) {\n      children.push(parseField());\n    }\n    buffer.push(token);\n    return { type: 'record', children };\n  }\n  function parseField(): RecordData {\n    let token = lexer();\n    if (token.type === TokenEnum.LEFT_CURLY_BRACE) {\n      const ret = parseRecordLabel();\n      if (lexer().type !== TokenEnum.RIGHT_CURLY_BRACE) {\n        throw new Error('Expect \\'}\\'');\n      }\n      return ret;\n    }\n    const result: Field = { type: 'field' };\n    if (token.type === TokenEnum.LEFT_ANGLE_BRACE) {\n      token = lexer();\n      if (token.type === TokenEnum.STRING) {\n        let port = token.text;\n        while ((token = lexer()).type === TokenEnum.STRING) {\n          port += ' ' + token.text;\n        }\n        result.port = port;\n      }\n      if (token.type !== TokenEnum.RIGHT_ANGLE_BRACE) {\n        throw new Error('Expect \\'>\\'');\n      }\n      token = lexer();\n    }\n    if (token.type === TokenEnum.STRING) {\n      let text = token.text;\n      while ((token = lexer()).type === TokenEnum.STRING) {\n        text += ' ' + token.text;\n      }\n      result.text = text;\n    }\n    buffer.push(token);\n    return result;\n  }\n  const tree = parseRecordLabel();\n  if (lexer().type !== TokenEnum.EOF) {\n    throw new Error('Unexpected token');\n  }\n  return tree;\n}\n","import {GraphData} from '@/graph/base/data';\nimport Root from '@/graph/Root';\nimport renderableFactory from '@/graph/base/renderableFactory';\nimport Edge from '@/graph/edge/Edge';\nimport layoutFactory from '@/graph/graph/layout';\nimport componentFactory from '@/graph/graph/component';\nimport graphTypeFactory from '@/graph/graph/type';\nimport Port from '@/graph/base/Port';\nimport Renderable from '@/graph/base/Renderable';\nimport Positioned from '@/graph/base/Positioned';\nimport GraphLayout, {LayoutData, LayoutEdgeData} from '@/graph/graph/layout/GraphLayout';\nimport ComponentLayout from '@/graph/graph/component/ComponentLayout';\nimport GraphType from '@/graph/graph/type/GraphType';\nimport GraphPhysics from '@/graph/graph/physics/GraphPhysics';\nimport physicsFactory from '@/graph/graph/physics';\n\nexport default class Graph extends Port implements Renderable {\n  public static getId(data: GraphData) {\n    if (!data.id) {\n      throw new Error('Missing id field for graph');\n    }\n    return data.id;\n  }\n  public readonly graph: Graph | null;\n  public fullId?: string;\n  public depth?: number;\n  public children?: Map<string, Renderable>;\n  public ports?: Map<string, Port>;\n  public subgraphs?: Map<string, Graph>;\n  public edges?: Map<string, Edge>;\n  public layouts?: GraphLayout[];\n  public physics?: GraphPhysics[];\n  public layoutsData?: LayoutData[];\n  public componentLayout?: ComponentLayout;\n  private graphType?: GraphType;\n  constructor(root: Root,\n              graph: Graph | null = null,\n              parent: Positioned | null = null) {\n    super(root, parent);\n    this.graph = graph;\n  }\n  public setData(data: GraphData) {\n    this.id = Graph.getId(data);\n    const newChildren = new Map();\n    this.depth = data.depth || 0;\n    this.fullId = data.parentId ? `${data.parentId}:${this.id}` : this.id;\n    if (data.children) {\n      for (const child of data.children) {\n        const type = renderableFactory(child);\n        const id = type.getId(child);\n        if (newChildren.has(id)) {\n          throw new Error('Duplicated id');\n        }\n        const newChild = this.children &&\n            this.children.has(id) &&\n            this.children.get(id)!.constructor === type ?\n            this.children.get(id)! : new type(this.root, this, null);\n        child.depth = this.depth + 1;\n        child.parentId = this.fullId;\n        newChild.setData(child);\n        newChildren.set(id, newChild);\n      }\n    }\n    // Create maps and arrays\n    this.children = newChildren;\n    this.edges = new Map();\n    this.ports = new Map();\n    this.subgraphs = new Map();\n    for (const [name, renderable] of this.children.entries()) {\n      if (renderable instanceof Edge) {\n        this.edges.set(name, renderable);\n      } else {\n        this.ports.set(name, renderable as any);\n        if (renderable instanceof Graph) {\n          this.subgraphs.set(name, renderable as any);\n        }\n      }\n    }\n    // Create adjacency list\n    const adjacencyList: Map<Port, Port[]> = new Map();\n    const edgesData: LayoutEdgeData[] = [];\n    for (const edge of this.edges.values()) {\n      const from = this.findPort(edge.from!.split(':'));\n      const to = this.findPort(edge.to!.split(':'));\n      const fromBelonging = this.findBelongingPort(edge.from!);\n      const toBelonging = this.findBelongingPort(edge.to!);\n      if (from && to && fromBelonging && toBelonging) {\n        if (!adjacencyList.has(fromBelonging)) {\n          adjacencyList.set(fromBelonging, []);\n        }\n        if (!adjacencyList.has(toBelonging)) {\n          adjacencyList.set(toBelonging, []);\n        }\n        adjacencyList.get(fromBelonging)!.push(toBelonging);\n        adjacencyList.get(toBelonging)!.push(fromBelonging);\n        edgesData.push({ from, to, fromBelonging, toBelonging, edge });\n      } else {\n        throw new Error('Cannot find starting or ending port of edge');\n      }\n    }\n    // Compute connected components by DFS\n    const unvisited: Set<Port> = new Set(this.ports.values());\n    this.layoutsData = [];\n    const calculateConnectedComponent = (from: Port) => {\n      unvisited.delete(from);\n      const component = this.layoutsData![this.layoutsData!.length - 1];\n      component.ports.push(from);\n      const adjacency = adjacencyList.get(from);\n      if (adjacency) {\n        for (const to of adjacency) {\n          if (unvisited.has(to)) {\n            calculateConnectedComponent(to);\n          }\n        }\n      }\n    };\n    while (unvisited.size) {\n      const node = unvisited.values().next().value;\n      const component: LayoutData = {\n        ports: [],\n        edges: [],\n        children: [],\n      };\n      this.layoutsData.push(component);\n      calculateConnectedComponent(node);\n    }\n    // Classify edges to belonging component\n    const portToComponent: Map<Port, LayoutData> = new Map();\n    for (const component of this.layoutsData) {\n      for (const port of component.ports) {\n        portToComponent.set(port, component);\n      }\n    }\n    for (const edgeData of edgesData) {\n      const {fromBelonging} = edgeData;\n      portToComponent.get(fromBelonging)!.edges.push(edgeData);\n    }\n    // Add children\n    for (const component of this.layoutsData) {\n      component.children = (component.ports as any[])\n        .concat(component.edges.map((x) => x.edge));\n    }\n    // Create layout\n    const componentClass = componentFactory(data.component);\n    if (!this.componentLayout ||\n        this.componentLayout.constructor !== componentClass) {\n      this.componentLayout = new componentClass(this, this);\n    }\n    const layoutClass = layoutFactory(data.layout);\n    const physicsClass = physicsFactory(data.physics);\n    const newLayouts: GraphLayout[] = [];\n    const newPhysics: GraphPhysics[] = [];\n    for (let i = 0; i < this.layoutsData.length; ++i) {\n      const layout = this.layouts && i < this.layouts.length &&\n        this.layouts[i].constructor === layoutClass ?\n        this.layouts[i] : new layoutClass(this, this.componentLayout);\n      const physics = this.physics && i < this.physics.length &&\n        this.physics[i].constructor === physicsClass ?\n        this.physics[i] : new physicsClass(this, layout);\n      for (const child of this.layoutsData[i].children) {\n        (child as any).parent = layout;\n      }\n      layout.solve(data.layout, this.layoutsData[i], i);\n      physics.solve(data.physics, this.layoutsData[i]);\n      newLayouts.push(layout);\n      newPhysics.push(physics);\n    }\n    this.layouts = newLayouts;\n    this.physics = newPhysics;\n    this.componentLayout.solve(data.component);\n    const typeClass = graphTypeFactory(data);\n    if (!this.graphType || this.graphType.constructor !== typeClass) {\n      this.graphType = new typeClass(this);\n    }\n    this.graphType.setData(data);\n  }\n  public step(): boolean {\n    let updated = false;\n    if (this.subgraphs) {\n      for (const subgraph of this.subgraphs.values()) {\n        if (subgraph.step()) {\n          updated = true;\n        }\n      }\n    }\n    if (this.physics) {\n      for (const physics of this.physics) {\n        if (physics.step()) {\n          updated = true;\n        }\n      }\n    }\n    return updated;\n  }\n  public render() {\n    return {\n      is: 'MyGroup',\n      key: this.id,\n      draggable: true,\n      id: this.fullId,\n      x: this.position.x,\n      y: this.position.y,\n      children: this.graphType!.render(),\n    };\n  }\n  public findBelongingPort(id: string): Port | null {\n    id = id.split(':')[0];\n    if (this.ports!.has(id)) {\n      return this.ports!.get(id)!;\n    }\n    for (const graph of this.subgraphs!.values()) {\n      if (graph.findBelongingPort(id)) {\n        return graph;\n      }\n    }\n    return null;\n  }\n  public findPort(id: string[]): Port | null {\n    if (id.length === 0) {\n      return this;\n    }\n    if (this.ports!.has(id[0])) {\n      const node = this.ports!.get(id[0])!;\n      return node.findPort(id.slice(1));\n    }\n    for (const graph of this.subgraphs!.values()) {\n      const node = graph.findPort(id);\n      if (node) {\n        return node;\n      }\n    }\n    return null;\n  }\n  public getBoundingBoxSize() {\n    return this.graphType!.getBoundingBoxSize();\n  }\n  public distanceToBorder(angle: number) {\n    return this.graphType!.distanceToBorder(angle);\n  }\n}\n\n\n\n\n\n\n","import Node from '@/graph/node/Node';\nimport {NodeData, Size} from '@/graph/base/data';\nimport Port from '@/graph/base/Port';\n\nexport default abstract class NodeType {\n  public readonly parent: Node;\n  protected constructor(parent: Node) {\n    this.parent = parent;\n  }\n  public abstract setData(data: NodeData): void;\n  public abstract render(): object[];\n  public findPort(id: string[]): Port | null {\n    return null;\n  }\n  public abstract getBoundingBoxSize(): Size;\n  public abstract distanceToBorder(angle: number): number;\n}\n","import NodeType from '@/graph/node/type/NodeType';\nimport Node from '@/graph/node/Node';\nimport {BoxNodeData, Size} from '@/graph/base/data';\n\ninterface BoxNodeConfig {\n  label: string | null;\n  style: 'solid' | 'filled';\n  fillColor: string;\n  strokeColor: string;\n  strokeWidth: number;\n  fontSize: number;\n  fontFamily: string;\n  lineHeight: number;\n  padding: number;\n  align: 'left' | 'center' | 'right';\n}\n\nexport default class BoxNodeType extends NodeType {\n  private static defaultConfig: BoxNodeConfig = {\n    label: null,\n    style: 'solid',  // or 'filled'\n    fillColor: 'white',\n    strokeColor: 'black',\n    strokeWidth: 1,\n    fontSize: 12,\n    fontFamily: 'sans-serif',\n    lineHeight: 1.2,\n    padding: 4,\n    align: 'center',\n  };\n  private config?: BoxNodeConfig;\n  private textSize?: Size;\n  private contentSize?: Size;\n  private borderSize?: Size;\n  constructor(parent: Node) {\n    super(parent);\n  }\n  public setData(data: BoxNodeData) {\n    const newConfig = Object.assign({}, BoxNodeType.defaultConfig, data);\n    const textSizeNeedsUpdate = !this.config ||\n      this.config.label !== newConfig.label ||\n      this.config.fontSize !== newConfig.fontSize ||\n      this.config.fontFamily !== newConfig.fontFamily ||\n      this.config.lineHeight !== newConfig.lineHeight;\n    const contentSizeNeedsUpdate = textSizeNeedsUpdate ||\n      this.config!.padding !== newConfig.padding;\n    const borderSizeNeedsUpdate = contentSizeNeedsUpdate ||\n      this.config!.strokeWidth !== newConfig.strokeWidth;\n    if (textSizeNeedsUpdate) {\n      const ctx = this.parent.root.ctx;\n      ctx.font = `${newConfig.fontSize}px ${newConfig.fontFamily}`;\n      const lines = newConfig.label ? newConfig.label.split('\\n') : [];\n      this.textSize = {\n        width: Math.max(...lines.map((x) => ctx.measureText(x).width), 0),\n        height: lines.length * newConfig.fontSize * newConfig.lineHeight,\n      };\n    }\n    if (contentSizeNeedsUpdate) {\n      this.contentSize = {\n        width: this.textSize!.width + 2 * newConfig.padding,\n        height: this.textSize!.height + 2 * newConfig.padding,\n      };\n    }\n    if (borderSizeNeedsUpdate) {\n      // Konva's border extends towards both inner and outer\n      this.borderSize = {\n        width: this.contentSize!.width + newConfig.strokeWidth,\n        height: this.contentSize!.height + newConfig.strokeWidth,\n      };\n    }\n    this.config = newConfig;\n  }\n  public render() {\n    const rect = {\n      is: 'MyRect',\n      key: 'rect',\n      x: -this.contentSize!.width / 2,\n      y: -this.contentSize!.height / 2,\n      width: this.contentSize!.width,\n      height: this.contentSize!.height,\n      fill: this.config!.style === 'filled' ?\n        this.config!.fillColor : undefined,\n      stroke: this.config!.strokeWidth > 0 ?\n        this.config!.strokeColor : undefined,\n      strokeWidth: this.config!.strokeWidth,\n    };\n    const rendered: object[] = [rect];\n    if (this.config!.label) {\n      const text = {\n        is: 'MyText',\n        key: 'text',\n        x: -this.contentSize!.width / 2,\n        y: -this.contentSize!.height / 2,\n        text: this.config!.label,\n        fontSize: this.config!.fontSize,\n        fontFamily: this.config!.fontFamily,\n        lineHeight: this.config!.lineHeight,\n        padding: this.config!.padding,\n        align: this.config!.align,\n      };\n      rendered.push(text);\n    }\n    return rendered;\n  }\n  public getBoundingBoxSize() {\n    return this.borderSize!;\n  }\n  public distanceToBorder(angle: number) {\n    return Math.min(\n      Math.abs(this.borderSize!.width / 2 / Math.cos(angle)),\n      Math.abs(this.borderSize!.height / 2 / Math.sin(angle)),\n    );\n  }\n}\n","import RecordNodeType from '@/graph/node/type/RecordNodeType';\nimport {Field, Record, RecordData} from '@/graph/node/type/recordParser';\nimport {Size} from '@/graph/base/data';\nimport Root from '@/graph/Root';\nimport Port from '@/graph/base/Port';\n\nexport default class RecordCell extends Port {\n  private readonly nodeType: RecordNodeType;\n  private isField?: boolean;\n  private isHorizontal?: boolean;\n  private label?: string;\n  private children?: RecordCell[];\n  private textSize?: Size;\n  private contentSize?: Size;\n  private cellSize?: Size;\n  constructor(root: Root, parent: Port, nodeType: RecordNodeType) {\n    super(root, parent);\n    this.nodeType = nodeType;\n  }\n  public setData(data: RecordData, isHorizontal = true) {\n    this.isField = data.type === 'field';\n    this.isHorizontal = isHorizontal;\n    if (this.isField) {\n      const fieldData = data as Field;\n      if (fieldData.port) {\n        this.nodeType.getPorts()!.set(fieldData.port, this);\n      }\n      const ctx = this.root.ctx;\n      const config = this.nodeType.getConfig()!;\n      this.label = fieldData.text;\n      ctx.font = `${config.fontSize}px ${config.fontFamily}`;\n      const lines =  this.label ?  this.label.split('\\n') : [];\n      this.textSize = {\n        width: Math.max(...lines.map((x) => ctx.measureText(x).width), 0),\n        height: lines.length * config.fontSize * config.lineHeight,\n      };\n      this.contentSize = {\n        width: this.textSize.width + 2 * config.padding,\n        height: this.textSize.height + 2 * config.padding,\n      };\n      this.cellSize = {\n        width: this.contentSize.width,\n        height: this.contentSize.height,\n      };\n    } else {\n      const recordData = data as Record;\n      this.children = [];\n      for (const child of recordData.children) {\n        const cell = new RecordCell(this.root, this, this.nodeType);\n        cell.setData(child, !isHorizontal);\n        this.children.push(cell);\n      }\n      if (isHorizontal) {\n        this.cellSize = {\n          width: this.children.map((x: RecordCell) => x.cellSize!.width)\n            .reduce((a, b) => a + b, 0),\n          height: Math.max(...this.children.map(\n            (x: RecordCell) => x.cellSize!.height)),\n        };\n      } else {\n        this.cellSize = {\n          width: Math.max(...this.children.map(\n            (x: RecordCell) => x.cellSize!.width)),\n          height: this.children.map((x: RecordCell) => x.cellSize!.height)\n            .reduce((a, b) => a + b, 0),\n        };\n      }\n    }\n  }\n  public setCellSize(width: number, height: number) {\n    if (!this.isField) {\n      if (this.isHorizontal) {\n        const deltaWidth = (width - this.cellSize!.width) / this.children!.length;\n        let startX = -width / 2;\n        for (const child of this.children!) {\n          child.setCellSize(child.cellSize!.width + deltaWidth, height);\n          child.position = {\n            x: startX + child.cellSize!.width / 2,\n            y: 0,\n          };\n          startX += child.cellSize!.width;\n        }\n      } else {\n        const deltaHeight = (height - this.cellSize!.height) /\n          this.children!.length;\n        let startY = -height / 2;\n        for (const child of this.children!) {\n          child.setCellSize(width, child.cellSize!.height + deltaHeight);\n          child.position = {\n            x: 0,\n            y: startY + child.cellSize!.height / 2,\n          };\n          startY += child.cellSize!.height;\n        }\n      }\n    }\n    this.cellSize = { width, height };\n  }\n  public getCellSize(): Size | undefined {\n    return this.cellSize;\n  }\n  public render(): object[] {\n    let rendered: object[];\n    if (this.isField) {\n      const config = this.nodeType.getConfig()!;\n      rendered = [\n        {\n          is: 'MyRect',\n          key: 'rect',\n          x: -this.cellSize!.width / 2,\n          y: -this.cellSize!.height / 2,\n          width: this.cellSize!.width,\n          height: this.cellSize!.height,\n          fill: config.style === 'filled' ? config.fillColor : undefined,\n          stroke: config.strokeWidth > 0 ? config.strokeColor : undefined,\n          strokeWidth: config.strokeWidth,\n        },\n      ];\n      if (this.label) {\n        rendered.push({\n          is: 'MyText',\n          key: 'text',\n          x: -this.contentSize!.width / 2,\n          y: -this.contentSize!.height / 2,\n          text: this.label,\n          fontSize: config.fontSize,\n          fontFamily: config.fontFamily,\n          lineHeight: config.lineHeight,\n          padding: config.padding,\n          align: config.align,\n        });\n      }\n    } else {\n      rendered = this.children!.map((x, i) => {\n        const position = x.getPosition();\n        return {\n          is: 'MyGroup',\n          key: `record-${i}`,\n          x: position.x,\n          y: position.y,\n          children: x.render(),\n        };\n      });\n    }\n    return rendered;\n  }\n  public getBoundingBoxSize(): Size {\n    const config = this.nodeType.getConfig()!;\n    return {\n      width: this.cellSize!.width + config.strokeWidth,\n      height: this.cellSize!.height + config.strokeWidth,\n    };\n  }\n  public distanceToBorder(angle: number): number {\n    const borderSize = this.getBoundingBoxSize();\n    return Math.min(\n      Math.abs(borderSize.width / 2 / Math.cos(angle)),\n      Math.abs(borderSize.height / 2 / Math.sin(angle)),\n    );\n  }\n}\n","import NodeType from './NodeType';\nimport Node from '@/graph/node/Node';\nimport recordParser from './recordParser';\nimport RecordCell from './RecordCell';\nimport {RecordNodeData, Size} from '@/graph/base/data';\nimport Port from '@/graph/base/Port';\n\ninterface RecordNodeConfig {\n  label: string;\n  direction: 'horizontal' | 'vertical';\n  style: 'solid' | 'filled';\n  fillColor: string;\n  strokeColor: string;\n  strokeWidth: number;\n  fontSize: number;\n  fontFamily: string;\n  lineHeight: number;\n  padding: number;\n  align: 'left' | 'center' | 'right';\n}\n\nexport default class RecordNodeType extends NodeType {\n  public static defaultConfig: RecordNodeConfig = {\n    label: '',\n    direction: 'horizontal', // or 'vertical'\n    style: 'solid',\n    fillColor: 'white',\n    strokeColor: 'black',\n    strokeWidth: 1,\n    fontSize: 12,\n    fontFamily: 'sans-serif',\n    lineHeight: 1.2,\n    padding: 4,\n    align: 'center',\n  };\n  private config?: RecordNodeConfig;\n  private ports?: Map<string, Port>;\n  private root?: RecordCell;\n  private borderSize?: Size;\n  constructor(parent: Node) {\n    super(parent);\n  }\n  public getConfig(): RecordNodeConfig | undefined {\n    return this.config;\n  }\n  public getPorts(): Map<string, Port> | undefined {\n    return this.ports;\n  }\n  public setData(data: RecordNodeData) {\n    const newConfig = Object.assign({}, RecordNodeType.defaultConfig, data);\n    const contentNeedsUpdate = !this.config ||\n      this.config.label !== newConfig.label ||\n      this.config.direction !== newConfig.direction ||\n      this.config.fontSize !== newConfig.fontSize ||\n      this.config.fontFamily !== newConfig.fontFamily ||\n      this.config.lineHeight !== newConfig.lineHeight ||\n      this.config.padding !== newConfig.padding;\n    const borderNeedsUpdate = contentNeedsUpdate ||\n      this.config!.strokeWidth !== newConfig.strokeWidth;\n    this.config = newConfig;\n    if (contentNeedsUpdate) {\n      const record = recordParser(data.label);\n      this.root = new RecordCell(this.parent.root, this.parent, this);\n      this.ports = new Map();\n      this.root.setData(record, this.config.direction === 'horizontal');\n      const rootCellSize = this.root.getCellSize()!;\n      this.root.setCellSize(rootCellSize.width, rootCellSize.height);\n    }\n    if (borderNeedsUpdate) {\n      const rootCellSize = this.root!.getCellSize()!;\n      this.borderSize = {\n        width: rootCellSize.width + this.config.strokeWidth,\n        height: rootCellSize.height + this.config.strokeWidth,\n      };\n    }\n  }\n  public render() {\n    return this.root!.render();\n  }\n  public findPort(id: string[]): Port | null {\n    if (id.length === 1) {\n      const founded = this.ports!.get(id[0]);\n      if (founded) {\n        return founded;\n      }\n      return null;\n    }\n    return null;\n  }\n  public getBoundingBoxSize() {\n    return this.borderSize!;\n  }\n  public distanceToBorder(angle: number) {\n    return Math.min(\n      Math.abs(this.borderSize!.width / 2 / Math.cos(angle)),\n      Math.abs(this.borderSize!.height / 2 / Math.sin(angle)),\n    );\n  }\n}\n","import TableNodeType from '@/graph/node/type/TableNodeType';\nimport Root from '@/graph/Root';\nimport {Element} from 'xml-js';\nimport {Size} from '@/graph/base/data';\nimport Port from '@/graph/base/Port';\n\ninterface TableCellConfig {\n  rowSpan: number;\n  columnSpan: number;\n  border: number;\n  backgroundColor: string;\n}\n\nexport default class TableCell extends Port {\n  public rowOffset?: number;\n  public columnOffset?: number;\n  public contentSize?: Size;\n  public cellSize?: Size;\n  private readonly nodeType: TableNodeType;\n  private config?: TableCellConfig;\n  private port?: string;\n  private label?: string;\n  private textSize?: Size;\n  constructor(root: Root, parent: Port, nodeType: TableNodeType) {\n     super(root, parent);\n     this.nodeType = nodeType;\n  }\n  public setData(data: any) {\n    this.config = {\n      rowSpan: 1,\n      columnSpan: 1,\n      border: this.nodeType.getTableConfig()!.cellBorder,\n      backgroundColor: 'white',\n    };\n    if (data.attributes) {\n      for (const attribute of Object.keys(data.attributes)) {\n        const value = data.attributes[attribute];\n        switch (attribute.toLowerCase()) {\n          case 'rowspan':\n            this.config.rowSpan = parseInt(value, 10);\n            break;\n          case 'colspan':\n            this.config.columnSpan = parseInt(value, 10);\n            break;\n          case 'border':\n            this.config.border = parseInt(value, 10);\n            break;\n          case 'bgcolor':\n            this.config.backgroundColor = value;\n            break;\n          case 'port':\n            this.port = value;\n            break;\n          default:\n            throw new Error('Unknown attribute for table cell');\n        }\n      }\n    }\n    function getText(element: Element): string {\n      switch (element.type) {\n        case 'text':\n          if (typeof element.text === 'string') {\n            return element.text;\n          }\n          return '';\n        case 'element':\n          if (element.name && element.name.toLowerCase() === 'br') {\n            return '\\n';\n          }\n          if (element.elements) {\n            return element.elements.map(getText).join('');\n          } else {\n            return '';\n          }\n        default:\n          throw new Error('Unknown element type');\n      }\n    }\n    this.label = getText(data);\n    const parentConfig = this.nodeType.getConfig()!;\n    const tableConfig = this.nodeType.getTableConfig()!;\n    const ctx = this.root.ctx;\n    ctx.font = `${parentConfig.fontSize}px ${parentConfig.fontFamily}`;\n    const lines = this.label ? this.label.split('\\n') : [];\n    this.textSize = {\n      width: Math.max(...lines.map((x) => ctx.measureText(x).width), 0),\n      height: lines.length * parentConfig.fontSize * parentConfig.lineHeight,\n    };\n    this.contentSize = {\n      width: this.textSize.width + 2 * tableConfig.cellPadding,\n      height: this.textSize.height + 2 * tableConfig.cellPadding,\n    };\n    this.cellSize = {\n      width: this.contentSize.width,\n      height: this.contentSize.height,\n    };\n    this.rowOffset = 0;\n    this.columnOffset = 0;\n  }\n  public render() {\n    const rect = {\n      is: 'MyRect',\n      key: 'rect',\n      x: -this.cellSize!.width / 2,\n      y: -this.cellSize!.height / 2,\n      width: this.cellSize!.width,\n      height: this.cellSize!.height,\n      fill: this.config!.backgroundColor,\n      stroke: this.config!.border > 0 ? 'black' : undefined,\n      strokeWidth: this.config!.border,\n    };\n    const rendered: object[] = [rect];\n    if (this.label) {\n      const parentConfig = this.nodeType.getConfig()!;\n      const text = {\n        is: 'MyText',\n        key: 'text',\n        x: -this.contentSize!.width / 2,\n        y: -this.contentSize!.height / 2,\n        text: this.label,\n        fontSize: parentConfig.fontSize,\n        fontFamily: parentConfig.fontFamily,\n        lineHeight: parentConfig.lineHeight,\n        padding: this.nodeType.getTableConfig()!.cellPadding,\n        align: 'center',\n      };\n      rendered.push(text);\n    }\n    return {\n      is: 'MyGroup',\n      key: `cell-${this.rowOffset}-${this.columnOffset}`,\n      x: this.position.x,\n      y: this.position.y,\n      children: rendered,\n    };\n  }\n  public getConfig(): TableCellConfig | undefined {\n    return this.config;\n  }\n  public getPort(): string | undefined {\n    return this.port;\n  }\n  public getBoundingBoxSize() {\n    return {\n      width: this.cellSize!.width + this.config!.border,\n      height: this.cellSize!.height + this.config!.border,\n    };\n  }\n  public distanceToBorder(angle: number) {\n    const borderSize = this.getBoundingBoxSize();\n    return Math.min(\n      Math.abs(borderSize.width / 2 / Math.cos(angle)),\n      Math.abs(borderSize.height / 2 / Math.sin(angle)),\n    );\n  }\n}\n","import convert, {Element} from 'xml-js';\nimport NodeType from './NodeType';\nimport TableCell from './TableCell';\nimport Node from '@/graph/node/Node';\nimport {Size, TableNodeData} from '@/graph/base/data';\nimport Port from '@/graph/base/Port';\n\ninterface TableNodeConfig {\n  label: string;\n  fontSize: number;\n  fontFamily: string;\n  lineHeight: number;\n}\n\ninterface TableConfig {\n  border: number;\n  cellBorder: number;\n  cellSpacing: number;\n  cellPadding: number;\n}\n\nexport default class TableNodeType extends NodeType {\n  public static defaultConfig: TableNodeConfig = {\n    label: '',\n    fontSize: 12,\n    fontFamily: 'sans-serif',\n    lineHeight: 1.2,\n  };\n  private config?: TableNodeConfig;\n  private tableConfig?: TableConfig;\n  private table?: TableCell[][];\n  private ports?: Map<string, Port>;\n  private contentSize?: Size;\n  private borderSize?: Size;\n  constructor(parent: Node) {\n    super(parent);\n  }\n  public setData(data: TableNodeData) {\n    const newConfig = Object.assign({}, TableNodeType.defaultConfig, data);\n    const layoutNeedsUpdate = !this.config ||\n      this.config.label !== newConfig.label ||\n      this.config.fontSize !== newConfig.fontSize ||\n      this.config.fontFamily !== newConfig.fontFamily ||\n      this.config.lineHeight !== newConfig.lineHeight;\n    this.config = newConfig;\n    if (layoutNeedsUpdate) {\n      const jsonObj = convert.xml2js(this.config.label) as Element;\n      if (!jsonObj.elements || !jsonObj.elements[0] ||\n          !jsonObj.elements[0].name ||\n          jsonObj.elements[0].name.toLowerCase() !== 'table') {\n        throw new Error('Expect table element');\n      }\n      const tableElement = jsonObj.elements[0];\n      this.tableConfig = {\n        border: 0,\n        cellBorder: 1,\n        cellSpacing: 0,\n        cellPadding: 4,\n      };\n      if (tableElement.attributes) {\n        for (const attribute of Object.keys(tableElement.attributes)) {\n          const value = tableElement.attributes[attribute] as string;\n          switch (attribute.toLowerCase()) {\n            case 'border':\n              this.tableConfig.border = parseInt(value, 10);\n              break;\n            case 'cellborder':\n              this.tableConfig.cellBorder = parseInt(value, 10);\n              break;\n            case 'cellspacing':\n              this.tableConfig.cellSpacing = parseInt(value, 10);\n              break;\n            case 'cellpadding':\n              this.tableConfig.cellPadding = parseInt(value, 10);\n              break;\n            default:\n              throw new Error('Unknown attribute for table');\n          }\n        }\n      }\n      // Parse table and get numbers of rows and columns\n      this.table = [];\n      this.ports = new Map();\n      let rows = 0;\n      let columns = 0;\n      let firstRow = true;\n      if (tableElement.elements) {\n        for (const tr of tableElement.elements) {\n          if (!tr.name || tr.name.toLowerCase() !== 'tr') {\n            throw new Error('Expect tr element');\n          }\n          const row = [];\n          if (tr.elements) {\n            for (const td of tr.elements) {\n              if (!td.name || td.name.toLowerCase() !== 'td') {\n                throw new Error('Expect td element');\n              }\n              const cell = new TableCell(this.parent.root, this.parent, this);\n              cell.setData(td);\n              const port = cell.getPort();\n              if (port) {\n                this.ports.set(port, cell);\n              }\n              if (firstRow) {\n                columns += cell.getConfig()!.columnSpan;\n              }\n              row.push(cell);\n            }\n          }\n          ++rows;\n          if (firstRow) {\n            firstRow = false;\n          }\n          this.table.push(row);\n        }\n      }\n      // Create empty cell size table\n      const cellSizes = [];\n      for (let i = 0; i < rows; ++i) {\n        cellSizes.push(Array(columns).fill(null));\n      }\n      // Fill size table with minimum required size\n      for (let rowOffset = 0; rowOffset < rows; ++rowOffset) {\n        let columnOffset = 0;\n        for (const cell of this.table[rowOffset]) {\n          while (columnOffset < columns && cellSizes[rowOffset][columnOffset]) {\n            ++columnOffset;\n          }\n          cell.rowOffset = rowOffset;\n          cell.columnOffset = columnOffset;\n          const {rowSpan, columnSpan} = cell.getConfig()!;\n          const cellHeight = (cell.contentSize!.height -\n            (rowSpan - 1) * this.tableConfig.cellSpacing) / rowSpan;\n          const cellWidth = (cell.contentSize!.width -\n            (columnSpan - 1) * this.tableConfig.cellSpacing) / columnSpan;\n          for (let i = 0; i < rowSpan; ++i) {\n            for (let j = 0; j < columnSpan; ++j) {\n              cellSizes[rowOffset + i][columnOffset + j] = {\n                width: cellWidth,\n                height: cellHeight,\n              };\n            }\n          }\n          columnOffset += columnSpan;\n        }\n      }\n      // Get height of rows and width of columns\n      const rowHeight = [];\n      const columnWidth = [];\n      for (let i = 0; i < rows; ++i) {\n        let max = -Infinity;\n        for (let j = 0; j < columns; ++j) {\n          if (cellSizes[i][j].height > max) {\n            max = cellSizes[i][j].height;\n          }\n        }\n        rowHeight.push(max);\n      }\n      for (let j = 0; j < columns; ++j) {\n        let max = -Infinity;\n        for (let i = 0; i < rows; ++i) {\n          if (cellSizes[i][j].width > max) {\n            max = cellSizes[i][j].width;\n          }\n        }\n        columnWidth.push(max);\n      }\n      // Get accumulated height and width\n      const accRowHeight = [0];\n      const accColumnWidth = [0];\n      for (let i = 0; i < rows; ++i) {\n        accRowHeight.push(accRowHeight[i] + rowHeight[i] +\n          this.tableConfig.cellSpacing);\n      }\n      for (let i = 0; i < columns; ++i) {\n        accColumnWidth.push(accColumnWidth[i] + columnWidth[i] +\n          this.tableConfig.cellSpacing);\n      }\n      this.contentSize = {\n        width: accColumnWidth[accColumnWidth.length - 1] -\n          this.tableConfig.cellSpacing,\n        height: accRowHeight[accRowHeight.length - 1] -\n          this.tableConfig.cellSpacing,\n      };\n      // Set size and position to cells\n      for (const row of this.table) {\n        for (const cell of row) {\n          const {rowSpan, columnSpan} = cell.getConfig()!;\n          const {rowOffset, columnOffset} = cell;\n          const upperLeftX = accColumnWidth[columnOffset!];\n          const upperLeftY = accRowHeight[rowOffset!];\n          const width = accColumnWidth[columnOffset! + columnSpan] -\n            upperLeftX - this.tableConfig.cellSpacing;\n          const height = accRowHeight[rowOffset! + rowSpan] -\n            upperLeftY - this.tableConfig.cellSpacing;\n          cell.setPosition({\n            x: upperLeftX + width / 2 - this.contentSize.width / 2,\n            y: upperLeftY + height / 2 - this.contentSize.height / 2,\n          });\n          cell.cellSize = { width, height };\n        }\n      }\n      this.borderSize = {\n        width: this.contentSize.width + this.tableConfig.border +\n          2 * this.tableConfig.cellSpacing,\n        height: this.contentSize.height + this.tableConfig.border +\n          2 * this.tableConfig.cellSpacing,\n      };\n    }\n  }\n  public render() {\n    const rendered = [];\n    rendered.push( {\n      is: 'MyRect',\n      key: 'rect',\n      x: -this.contentSize!.width / 2 - this.tableConfig!.cellSpacing,\n      y: -this.contentSize!.height / 2 - this.tableConfig!.cellSpacing,\n      width: this.contentSize!.width + 2 * this.tableConfig!.cellSpacing,\n      height: this.contentSize!.height + 2 * this.tableConfig!.cellSpacing,\n      fill: 'white',\n      stroke: this.tableConfig!.border > 0 ? 'black' : undefined,\n      strokeWidth: this.tableConfig!.border,\n    });\n    for (const row of this.table!) {\n      for (const cell of row) {\n        rendered.push(cell.render());\n      }\n    }\n    return rendered;\n  }\n  public getConfig(): TableNodeConfig | undefined {\n    return this.config;\n  }\n  public getTableConfig(): TableConfig | undefined {\n    return this.tableConfig;\n  }\n  public findPort(id: string[]): Port | null {\n    if (id.length === 1) {\n      const founded = this.ports!.get(id[0]);\n      if (founded) {\n        return founded;\n      }\n      return null;\n    }\n    return null;\n  }\n  public getBoundingBoxSize() {\n    return this.borderSize!;\n  }\n  public distanceToBorder(angle: number) {\n    return Math.min(\n      Math.abs(this.borderSize!.width / 2 / Math.cos(angle)),\n      Math.abs(this.borderSize!.height / 2 / Math.sin(angle)),\n    );\n  }\n}\n","import BoxNodeType from '@/graph/node/type/BoxNodeType';\nimport NodeType from '@/graph/node/type/NodeType';\nimport {NodeData} from '@/graph/base/data';\nimport Node from '@/graph/node/Node';\nimport RecordNodeType from '@/graph/node/type/RecordNodeType';\nimport TableNodeType from '@/graph/node/type/TableNodeType';\n\nexport default function nodeTypeFactory(data: NodeData)\n    : new (parent: Node) => NodeType {\n  switch (data.shape) {\n    case 'table':\n      return TableNodeType;\n    case 'record':\n      return RecordNodeType;\n    default:\n      return BoxNodeType;\n  }\n}\n","import {NodeData} from '@/graph/base/data';\nimport Root from '@/graph/Root';\nimport nodeTypeFactory from '@/graph/node/type';\nimport NodeType from '@/graph/node/type/NodeType';\nimport Renderable from '@/graph/base/Renderable';\nimport Port from '@/graph/base/Port';\nimport Positioned from '@/graph/base/Positioned';\nimport Graph from '@/graph/graph/Graph';\n\nexport default class Node extends Port implements Renderable {\n  public static getId(data: NodeData) {\n    if (!data.id) {\n      throw new Error('Missing id field for node');\n    }\n    return data.id;\n  }\n  public readonly graph: Graph | null;\n  public fullId?: string;\n  private nodeType?: NodeType;\n  constructor(root: Root,\n              graph: Graph | null = null,\n              parent: Positioned | null = null) {\n    super(root, parent);\n    this.graph = graph;\n  }\n  public setData(data: NodeData) {\n    this.id = Node.getId(data);\n    this.fullId = data.parentId ? `${data.parentId}:${this.id}` : this.id;\n    const typeClass = nodeTypeFactory(data);\n    if (!this.nodeType || this.nodeType.constructor !== typeClass) {\n      this.nodeType = new typeClass(this);\n    }\n    this.nodeType.setData(data);\n  }\n  public render() {\n    return {\n      is: 'MyGroup',\n      key: this.id,\n      draggable: true,\n      id: this.fullId,\n      x: this.position.x,\n      y: this.position.y,\n      children: this.nodeType!.render(),\n    };\n  }\n  public findPort(id: string[]): Port | null {\n    if (id.length === 0) {\n      return this;\n    }\n    return this.nodeType!.findPort(id);\n  }\n  public getBoundingBoxSize() {\n    return this.nodeType!.getBoundingBoxSize();\n  }\n  public distanceToBorder(angle: number) {\n    return this.nodeType!.distanceToBorder(angle);\n  }\n}\n","import Root from '@/graph/Root';\nimport Edge from '@/graph/edge/Edge';\nimport Graph from '@/graph/graph/Graph';\nimport Node from '@/graph/node/Node';\nimport {RenderableData} from '@/graph/base/data';\nimport Renderable from '@/graph/base/Renderable';\nimport Positioned from '@/graph/base/Positioned';\n\ninterface RenderableConstructor {\n  new (root: Root, graph: Graph | null,\n       parent: Positioned | null): Renderable;\n  getId(data: RenderableData): string;\n}\n\nexport default function renderableFactory(data: RenderableData)\n    : RenderableConstructor {\n  switch (data.type) {\n    case 'node':\n      return Node;\n    case 'edge':\n      return Edge;\n    case 'graph':\n      return Graph;\n    default:\n      throw new Error('Unknown renderable object');\n  }\n}\n","export default \"digraph stdThreadJoin {\\nlabel=\\\" VFG of stdThreadJoin\\\"\\ngraph [rankdir=\\\"LR\\\"]\\nsubgraph cluster_input {\\nlabel=\\\"Inputs\\\"\\nstyle=filled\\ncolor=black\\nfillcolor=darkolivegreen1\\nN912 [label=\\\"N912\\\\n[arg:stdThreadJoin_0]\\\", style=filled, fillcolor=\\\"cyan3\\\", shape=box]\\nN913 [label=\\\"N913\\\\n[arg:stdThreadJoin_0]*\\\", style=filled, fillcolor=\\\"cyan3\\\", shape=box]\\n} # end of input\\nsubgraph cluster_output {\\nlabel=\\\"Outputs\\\"\\nstyle=filled\\ncolor=black\\nfillcolor=goldenrod1\\nN940 [label=\\\"N940\\\\n_\\\", style=filled, fillcolor=\\\"cornflowerblue\\\", shape=box]\\n} # end of output\\n# body nodes\\nN919 [label=\\\"N919\\\\n&dummy\\\", style=filled, fillcolor=\\\"cyan3\\\", shape=box]\\nN925 [label=\\\"N925\\\\n0\\\", style=filled, fillcolor=\\\"lightgrey\\\", shape=box]\\nN926 [label=<<table  border='0' cellspacing='0'><tr><td port='top' bgcolor='palegreen' border='1'>N926(%6)<br/>getelementptr</td></tr><tr><td port='op_1' border='1'>N912</td></tr><tr><td port='op_2' border='1'>N925</td></tr><tr><td port='op_3' border='1'>N925</td></tr></table>>, shape=none]\\nN927 [label=\\\"N927\\\\nDEREF\\\", style=filled, fillcolor=\\\"gainsboro\\\", shape=box]\\nN928 [label=\\\"N928\\\\nstdThreadJoin::6*\\\", style=filled, fillcolor=\\\"cyan3\\\", shape=box]\\nN930 [label=\\\"N930\\\\n[arg:_pthread_join_0]\\\", style=filled, fillcolor=\\\"cornflowerblue\\\", shape=box]\\nN931 [label=\\\"N931\\\\n[arg:_pthread_join_1]\\\", style=filled, fillcolor=\\\"cornflowerblue\\\", shape=box]\\nN932 [label=\\\"N932\\\\nstdThreadJoin::8\\\", style=filled, fillcolor=\\\"cyan3\\\", shape=box]\\nN933 [label=<<table  border='0' cellspacing='0'><tr><td port='top' bgcolor='palegreen' border='1'>N933(%9)<br/>icmp ne</td></tr><tr><td port='op_1' border='1'>N925</td></tr><tr><td port='op_2' border='1'>N932</td></tr></table>>, shape=none]\\nN934 [label=\\\"N934\\\\n1\\\", style=filled, fillcolor=\\\"lightgrey\\\", shape=box]\\nN937 [label=\\\"N937\\\\n&gamma;\\\", style=filled, fillcolor=\\\"darksalmon\\\", shape=box]\\n# proxy\\nP595 [label=\\\"\\\",style=filled,color=crimson,fillcolor=crimson,shape=circle,height=0.05,width=0.05]\\nP596 [label=\\\"\\\",style=filled,color=crimson,fillcolor=crimson,shape=circle,height=0.05,width=0.05]\\n# end of body\\nN937 -> N940\\nN912 -> N926:op_1\\nN925 -> N926:op_2\\nN925 -> N926:op_3\\nN926:top -> N927\\nN928 -> N930\\nN919 -> N931\\nN925 -> N933:op_1\\nN932 -> N933:op_2\\nN925 -> P595 [arrowhead=none]\\nP595 -> N937\\nN933:top -> P595 [label=\\\"N933\\\",style=dotted,color=crimson]\\nN934 -> P596 [arrowhead=none]\\nP596 -> N937\\nN933:top -> P596 [label=\\\"!(N933)\\\",style=dotted,color=crimson]\\nCS_31 [shape=record,style=bold,label=\\\"_pthread_join | { {<cs_id_in_0> N930 | <cs_id_in_1> N931} | {<cs_id_out_0> N932} }\\\"]\\nN930 -> CS_31:cs_id_in_0\\nN931 -> CS_31:cs_id_in_1\\nCS_31:cs_id_out_0 -> N932\\n}\\n\"","export default \"{\\n  \\\"type\\\": \\\"graph\\\",\\n  \\\"id\\\": \\\"stdThreadJoin\\\",\\n  \\\"label\\\": \\\"VFG of stdThreadJoin\\\",\\n  \\\"layout\\\": {\\n    \\\"type\\\": \\\"KamadaKawai\\\",\\n    \\\"springLength\\\": 150,\\n    \\\"direction\\\": \\\"LR\\\"\\n  },\\n  \\\"children\\\": [\\n    {\\n      \\\"type\\\": \\\"graph\\\",\\n      \\\"id\\\": \\\"cluster_input\\\",\\n      \\\"label\\\": \\\"Inputs\\\",\\n      \\\"style\\\": \\\"filled\\\",\\n      \\\"fillColor\\\": \\\"darkolivegreen\\\",\\n      \\\"strokeWidth\\\": 1,\\n      \\\"strokeColor\\\": \\\"black\\\",\\n      \\\"children\\\": [\\n        {\\n          \\\"type\\\": \\\"node\\\",\\n          \\\"id\\\": \\\"N912\\\",\\n          \\\"label\\\": \\\"N912\\\\n[arg:stdThreadJoin_0]\\\",\\n          \\\"style\\\": \\\"filled\\\",\\n          \\\"fillColor\\\": \\\"cyan\\\",\\n          \\\"shape\\\": \\\"box\\\"\\n        },\\n        {\\n          \\\"type\\\": \\\"node\\\",\\n          \\\"id\\\": \\\"N913\\\",\\n          \\\"label\\\": \\\"N913\\\\n[arg:stdThreadJoin_0]*\\\",\\n          \\\"style\\\": \\\"filled\\\",\\n          \\\"fillColor\\\": \\\"cyan\\\",\\n          \\\"shape\\\": \\\"box\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"type\\\": \\\"graph\\\",\\n      \\\"id\\\": \\\"cluster_output\\\",\\n      \\\"label\\\": \\\"Outputs\\\",\\n      \\\"style\\\": \\\"filled\\\",\\n      \\\"fillColor\\\": \\\"goldenrod\\\",\\n      \\\"strokeWidth\\\": 1,\\n      \\\"strokeColor\\\": \\\"black\\\",\\n      \\\"children\\\": [\\n        {\\n          \\\"type\\\": \\\"node\\\",\\n          \\\"id\\\": \\\"N940\\\",\\n          \\\"label\\\": \\\"N940\\\\n_\\\",\\n          \\\"style\\\": \\\"filled\\\",\\n          \\\"fillColor\\\": \\\"cornflowerblue\\\",\\n          \\\"shape\\\": \\\"box\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"N919\\\",\\n      \\\"label\\\": \\\"N919\\\\n&dummy\\\",\\n      \\\"style\\\": \\\"filled\\\",\\n      \\\"fillColor\\\": \\\"cyan\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"N925\\\",\\n      \\\"label\\\": \\\"N925\\\\n0\\\",\\n      \\\"style\\\": \\\"filled\\\",\\n      \\\"fillColor\\\": \\\"lightgrey\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"N926\\\",\\n      \\\"label\\\": \\\"<table  border='0' cellspacing='0'><tr><td port='top' bgcolor='palegreen' border='1'>N926(%6)<br/>getelementptr</td></tr><tr><td port='op_1' border='1'>N912</td></tr><tr><td port='op_2' border='1'>N925</td></tr><tr><td port='op_3' border='1'>N925</td></tr></table>\\\",\\n      \\\"shape\\\": \\\"table\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"N927\\\",\\n      \\\"label\\\": \\\"N927\\\\nDEREF\\\",\\n      \\\"style\\\": \\\"filled\\\",\\n      \\\"fillColor\\\": \\\"gainsboro\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"N928\\\",\\n      \\\"label\\\": \\\"N928\\\\nstdThreadJoin::6*\\\",\\n      \\\"style\\\": \\\"filled\\\",\\n      \\\"fillColor\\\": \\\"cyan\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"N930\\\",\\n      \\\"label\\\": \\\"N930\\\\n[arg:_pthread_join_0]\\\",\\n      \\\"style\\\": \\\"filled\\\",\\n      \\\"fillColor\\\": \\\"cornflowerblue\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"N931\\\",\\n      \\\"label\\\": \\\"N931\\\\n[arg:_pthread_join_1]\\\",\\n      \\\"style\\\": \\\"filled\\\",\\n      \\\"fillColor\\\": \\\"cornflowerblue\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"N932\\\",\\n      \\\"label\\\": \\\"N932\\\\nstdThreadJoin::8\\\",\\n      \\\"style\\\": \\\"filled\\\",\\n      \\\"fillColor\\\": \\\"cyan\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"N933\\\",\\n      \\\"label\\\": \\\"<table  border='0' cellspacing='0'><tr><td port='top' bgcolor='palegreen' border='1'>N933(%9)<br/>icmp ne</td></tr><tr><td port='op_1' border='1'>N925</td></tr><tr><td port='op_2' border='1'>N932</td></tr></table>\\\",\\n      \\\"shape\\\": \\\"table\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"N934\\\",\\n      \\\"label\\\": \\\"N934\\\\n1\\\",\\n      \\\"style\\\": \\\"filled\\\",\\n      \\\"fillColor\\\": \\\"lightgrey\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"N937\\\",\\n      \\\"label\\\": \\\"N937\\\\n&gamma;\\\",\\n      \\\"style\\\": \\\"filled\\\",\\n      \\\"fillColor\\\": \\\"darksalmon\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"P595\\\",\\n      \\\"label\\\": \\\"\\\",\\n      \\\"style\\\": \\\"filled\\\",\\n      \\\"color\\\": \\\"crimson\\\",\\n      \\\"fillColor\\\": \\\"crimson\\\",\\n      \\\"shape\\\": \\\"circle\\\",\\n      \\\"radius\\\": 0.025\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"P596\\\",\\n      \\\"label\\\": \\\"\\\",\\n      \\\"style\\\": \\\"filled\\\",\\n      \\\"color\\\": \\\"crimson\\\",\\n      \\\"fillColor\\\": \\\"crimson\\\",\\n      \\\"shape\\\": \\\"circle\\\",\\n      \\\"radius\\\": 0.025\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"N937\\\",\\n      \\\"to\\\": \\\"N940\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"N912\\\",\\n      \\\"to\\\": \\\"N926:op_1\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"N925\\\",\\n      \\\"to\\\": \\\"N926:op_2\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"N925\\\",\\n      \\\"to\\\": \\\"N926:op_3\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"N926:top\\\",\\n      \\\"to\\\": \\\"N927\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"N928\\\",\\n      \\\"to\\\": \\\"N930\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"N919\\\",\\n      \\\"to\\\": \\\"N931\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"N925\\\",\\n      \\\"to\\\": \\\"N933:op_1\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"N932\\\",\\n      \\\"to\\\": \\\"N933:op_2\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"N925\\\",\\n      \\\"to\\\": \\\"P595\\\",\\n      \\\"arrowHead\\\": \\\"none\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"P595\\\",\\n      \\\"to\\\": \\\"N937\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"N933:top\\\",\\n      \\\"to\\\": \\\"P595\\\",\\n      \\\"label\\\": \\\"N933\\\",\\n      \\\"style\\\": \\\"dotted\\\",\\n      \\\"color\\\": \\\"crimson\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"N934\\\",\\n      \\\"to\\\": \\\"P596\\\",\\n      \\\"arrowHead\\\": \\\"none\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"P596\\\",\\n      \\\"to\\\": \\\"N937\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"N933:top\\\",\\n      \\\"to\\\": \\\"P596\\\",\\n      \\\"label\\\": \\\"!(N933)\\\",\\n      \\\"style\\\": \\\"dotted\\\",\\n      \\\"color\\\": \\\"crimson\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"CS_31\\\",\\n      \\\"shape\\\": \\\"record\\\",\\n      \\\"style\\\": \\\"bold\\\",\\n      \\\"direction\\\": \\\"vertical\\\",\\n      \\\"label\\\": \\\"_pthread_join | { {<cs_id_in_0> N930 | <cs_id_in_1> N931} | {<cs_id_out_0> N932} }\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"N930\\\",\\n      \\\"to\\\": \\\"CS_31:cs_id_in_0\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"N931\\\",\\n      \\\"to\\\": \\\"CS_31:cs_id_in_1\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"CS_31:cs_id_out_0\\\",\\n      \\\"to\\\": \\\"N932\\\"\\n    }\\n  ]\\n}\\n\"","export default \"{\\n  \\\"type\\\": \\\"node\\\",\\n  \\\"id\\\": \\\"N926\\\",\\n  \\\"label\\\": \\\"hello\\\\\\\\nworld |{ b |{c|<here> d|e}| f}| g | h\\\",\\n  \\\"shape\\\": \\\"record\\\"\\n}\\n\"","export default \"{\\n  \\\"type\\\": \\\"graph\\\",\\n  \\\"id\\\": \\\"stdThreadJoin\\\",\\n  \\\"label\\\": \\\"VFG of stdThreadJoin\\\",\\n  \\\"layout\\\": {\\n    \\\"type\\\": \\\"KamadaKawai\\\",\\n    \\\"springLength\\\": 150\\n  },\\n  \\\"component\\\": {\\n    \\\"direction\\\": \\\"LR\\\"\\n  },\\n  \\\"children\\\": [\\n    {\\n      \\\"type\\\": \\\"graph\\\",\\n      \\\"id\\\": \\\"cluster_input\\\",\\n      \\\"component\\\": {\\n        \\\"direction\\\": \\\"TD\\\"\\n      },\\n      \\\"label\\\": \\\"Inputs\\\",\\n      \\\"style\\\": \\\"filled\\\",\\n      \\\"fillColor\\\": \\\"darkolivegreen\\\",\\n      \\\"strokeWidth\\\": 1,\\n      \\\"strokeColor\\\": \\\"black\\\",\\n      \\\"children\\\": [\\n        {\\n          \\\"type\\\": \\\"node\\\",\\n          \\\"id\\\": \\\"N921\\\",\\n          \\\"label\\\": \\\"N912\\\\n[arg:stdThreadJoin_0]\\\",\\n          \\\"style\\\": \\\"filled\\\",\\n          \\\"fillColor\\\": \\\"cyan\\\",\\n          \\\"shape\\\": \\\"box\\\"\\n        },\\n        {\\n          \\\"type\\\": \\\"node\\\",\\n          \\\"id\\\": \\\"N913\\\",\\n          \\\"label\\\": \\\"N913\\\\n[arg:stdThreadJoin_0]*\\\",\\n          \\\"style\\\": \\\"filled\\\",\\n          \\\"fillColor\\\": \\\"cyan\\\",\\n          \\\"shape\\\": \\\"box\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"type\\\": \\\"graph\\\",\\n      \\\"id\\\": \\\"cluster_output\\\",\\n      \\\"label\\\": \\\"Outputs\\\",\\n      \\\"style\\\": \\\"filled\\\",\\n      \\\"fillColor\\\": \\\"goldenrod\\\",\\n      \\\"strokeWidth\\\": 1,\\n      \\\"strokeColor\\\": \\\"black\\\",\\n      \\\"children\\\": [\\n        {\\n          \\\"type\\\": \\\"node\\\",\\n          \\\"id\\\": \\\"N940\\\",\\n          \\\"label\\\": \\\"N940\\\\n_\\\",\\n          \\\"style\\\": \\\"filled\\\",\\n          \\\"fillColor\\\": \\\"cornflowerblue\\\",\\n          \\\"shape\\\": \\\"box\\\"\\n        }\\n      ]\\n    }\\n  ]\\n}\\n\"","export default \"{\\n  \\\"type\\\": \\\"graph\\\",\\n  \\\"id\\\": \\\"cluster_input\\\",\\n  \\\"layout\\\": {\\n    \\\"type\\\": \\\"KamadaKawai\\\",\\n    \\\"direction\\\": \\\"LR\\\"\\n  },\\n  \\\"children\\\": [\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"0\\\",\\n      \\\"label\\\": \\\"0\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"1\\\",\\n      \\\"label\\\": \\\"1\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"2\\\",\\n      \\\"label\\\": \\\"2\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"3\\\",\\n      \\\"label\\\": \\\"3\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"4\\\",\\n      \\\"label\\\": \\\"4\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"5\\\",\\n      \\\"label\\\": \\\"5\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"6\\\",\\n      \\\"label\\\": \\\"6\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"7\\\",\\n      \\\"label\\\": \\\"7\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"8\\\",\\n      \\\"label\\\": \\\"8\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"9\\\",\\n      \\\"label\\\": \\\"9\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"10\\\",\\n      \\\"label\\\": \\\"10\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"11\\\",\\n      \\\"label\\\": \\\"11\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"0\\\",\\n      \\\"to\\\": \\\"1\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"1\\\",\\n      \\\"to\\\": \\\"2\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"2\\\",\\n      \\\"to\\\": \\\"0\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"0\\\",\\n      \\\"to\\\": \\\"3\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"3\\\",\\n      \\\"to\\\": \\\"2\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"3\\\",\\n      \\\"to\\\": \\\"4\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"4\\\",\\n      \\\"to\\\": \\\"0\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"4\\\",\\n      \\\"to\\\": \\\"5\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"5\\\",\\n      \\\"to\\\": \\\"0\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"5\\\",\\n      \\\"to\\\": \\\"1\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"1\\\",\\n      \\\"to\\\": \\\"8\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"8\\\",\\n      \\\"to\\\": \\\"5\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"5\\\",\\n      \\\"to\\\": \\\"7\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"7\\\",\\n      \\\"to\\\": \\\"4\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"4\\\",\\n      \\\"to\\\": \\\"6\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"6\\\",\\n      \\\"to\\\": \\\"3\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"3\\\",\\n      \\\"to\\\": \\\"10\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"10\\\",\\n      \\\"to\\\": \\\"2\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"2\\\",\\n      \\\"to\\\": \\\"9\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"9\\\",\\n      \\\"to\\\": \\\"1\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"8\\\",\\n      \\\"to\\\": \\\"9\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"9\\\",\\n      \\\"to\\\": \\\"10\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"10\\\",\\n      \\\"to\\\": \\\"6\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"6\\\",\\n      \\\"to\\\": \\\"7\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"7\\\",\\n      \\\"to\\\": \\\"8\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"11\\\",\\n      \\\"to\\\": \\\"8\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"11\\\",\\n      \\\"to\\\": \\\"9\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"11\\\",\\n      \\\"to\\\": \\\"10\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"11\\\",\\n      \\\"to\\\": \\\"6\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"11\\\",\\n      \\\"to\\\": \\\"7\\\"\\n    }\\n  ]\\n}\\n\"","export default \"{\\n  \\\"type\\\": \\\"node\\\",\\n  \\\"id\\\": \\\"N926\\\",\\n  \\\"label\\\": \\\"<TABLE BORDER=\\\\\\\"1\\\\\\\" CELLBORDER=\\\\\\\"1\\\\\\\" CELLSPACING=\\\\\\\"2\\\\\\\" CELLPADDING=\\\\\\\"4\\\\\\\"><TR><TD ROWSPAN=\\\\\\\"3\\\\\\\"><FONT COLOR=\\\\\\\"red\\\\\\\">hello</FONT><BR/>world</TD><TD COLSPAN=\\\\\\\"3\\\\\\\">b</TD><TD ROWSPAN=\\\\\\\"3\\\\\\\" BGCOLOR=\\\\\\\"lightgrey\\\\\\\">g</TD><TD ROWSPAN=\\\\\\\"3\\\\\\\">h</TD></TR><TR><TD>c</TD><TD PORT=\\\\\\\"here\\\\\\\">d</TD><TD>e</TD></TR><TR><TD COLSPAN=\\\\\\\"3\\\\\\\">f</TD></TR></TABLE>\\\",\\n  \\\"shape\\\": \\\"table\\\"\\n}\\n\"","export default \"{\\n  \\\"type\\\": \\\"graph\\\",\\n  \\\"id\\\": \\\"hello\\\",\\n  \\\"children\\\": [\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"0\\\",\\n      \\\"label\\\": \\\"0\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"1\\\",\\n      \\\"label\\\": \\\"1\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"node\\\",\\n      \\\"id\\\": \\\"2\\\",\\n      \\\"label\\\": \\\"2\\\",\\n      \\\"shape\\\": \\\"box\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"0\\\",\\n      \\\"to\\\": \\\"1\\\",\\n      \\\"lineWidth\\\": 5,\\n      \\\"pointerWidth\\\": 20,\\n      \\\"pointerHeight\\\": 30\\n    },\\n    {\\n      \\\"type\\\": \\\"edge\\\",\\n      \\\"from\\\": \\\"1\\\",\\n      \\\"to\\\": \\\"2\\\",\\n      \\\"shape\\\": \\\"straight\\\"\\n    }\\n  ]\\n}\\n\"","import EventEmitter from '@/graph/base/EventEmitter';\nimport { RenderableData } from '@/graph/base/data';\nimport renderableFactory from '@/graph/base/renderableFactory';\n\nexport default class Root extends EventEmitter {\n  public ctx: CanvasRenderingContext2D;\n  public child: Renderable | null;\n  public stepTimer: number;\n  public constructor() {\n    super();\n    this.ctx = document.createElement('canvas').getContext('2d')!;\n    this.child = null;\n    this.stepTimer = setInterval(() => {\n      if (this.child instanceof Graph) {\n        if (this.child.step()) {\n          this.refresh();\n        }\n      }\n    }, 1000 / 60);\n  }\n  public findPort(id: string[]) {\n    // noinspection SuspiciousTypeOfGuard\n    if (this.child instanceof Port) {\n      return this.child.findPort(id);\n    }\n    return null;\n  }\n  public setData(data: RenderableData) {\n    const newClass = renderableFactory(data);\n    if (this.child === null || this.child.constructor !== newClass) {\n      this.child = new newClass(this, null, null);\n    }\n    this.child!.setData(data);\n    this.refresh();\n  }\n  public redraw(data: RenderableData) {\n    this.child = new (renderableFactory(data))(this, null, null);\n    this.child.setData(data);\n    this.refresh();\n  }\n  public moveDraggable(fullId: string,\n                       delta: { deltaX: number, deltaY: number }) {\n    const id = fullId.split(':');\n    // noinspection SuspiciousTypeOfGuard\n    if (this.child instanceof Port) {\n      if (this.child.id !== id[0]) {\n        return null;\n      }\n      const element = this.findPort(id.slice(1));\n      if (element !== null) {\n        element.getPosition().x += delta.deltaX;\n        element.getPosition().y += delta.deltaY;\n        this.refresh();\n      }\n    }\n  }\n  public refresh() {\n    this.emit('render', [this.child!.render()]);\n  }\n}\n\nexport const globalRoot = new Root();\n// @ts-ignore\nwindow.globalRoot = globalRoot;\nexport const globalParsers\n    : { [input: string]: (input: string) => RenderableData } = {\n  json(input: string): RenderableData { return JSON.parse(input); },\n  graphviz(/* input: string */): RenderableData { throw new Error('Not implemented'); },\n};\n\n// Examples\nimport stdThreadJoinGv from '!raw-loader!./examples/stdThreadJoin.gv';\nimport stdThreadJoinJson from '!raw-loader!./examples/stdThreadJoin.txt';\nimport recordJson from '!raw-loader!./examples/record.txt';\nimport subGraphJson from '!raw-loader!./examples/subgraph.txt';\nimport icosahedronJson from '!raw-loader!./examples/icosahedron.txt';\nimport tableJson from '!raw-loader!./examples/table.txt';\nimport edgeJson from '!raw-loader!./examples/edge.txt';\nimport Renderable from '@/graph/base/Renderable';\nimport Port from '@/graph/base/Port';\nimport Graph from '@/graph/graph/Graph';\n\ninterface Example {\n  name: string;\n  parser: string;\n  content: string;\n}\n\nexport const globalExamples: Example[] = [\n  {\n    name: 'stdThreadJoinGv',\n    parser: 'graphviz',\n    content: stdThreadJoinGv,\n  },\n  {\n    name: 'stdThreadJoinJson',\n    parser: 'json',\n    content: stdThreadJoinJson,\n  },\n  {\n    name: 'record',\n    parser: 'json',\n    content: recordJson,\n  },\n  {\n    name: 'subGraph',\n    parser: 'json',\n    content: subGraphJson,\n  },\n  {\n    name: 'icosahedronJson',\n    parser: 'json',\n    content: icosahedronJson,\n  },\n  {\n    name: 'table',\n    parser: 'json',\n    content: tableJson,\n  },\n  {\n    name: 'edge',\n    parser: 'json',\n    content: edgeJson,\n  },\n];\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{style:({ width: _vm.width, height: _vm.height, position: 'relative' })},[(_vm.enableHit)?_c('canvas',{ref:\"hitCanvas\",staticStyle:{\"position\":\"absolute\",\"display\":\"none\"}}):_vm._e(),_c('canvas',_vm._g({ref:\"canvas\",staticStyle:{\"position\":\"absolute\"}},_vm.$listeners))])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {Vue, Component, Provide, Prop, Watch} from 'vue-property-decorator';\nimport CanvasProvider from '@/components/renderable/CanvasProvider';\n\n@Component\nexport default class MyCanvas extends Vue {\n  @Prop({ type: Number, required: true }) public readonly width!: number;\n  @Prop({ type: Number, required: true }) public readonly height!: number;\n  @Prop(Boolean) public readonly enableHit: boolean | undefined;\n  @Prop(Object) public readonly data: object | undefined;\n  @Provide() public provider: CanvasProvider = {\n    context: null,\n    hitContext: null,\n    hitColorMap: {},\n    hitIdMap: {},\n  };\n  public mounted() {\n    this.provider.context = (this.$refs.canvas as HTMLCanvasElement)\n      .getContext('2d');\n    (this.$refs.canvas as HTMLCanvasElement).width = this.width;\n    (this.$refs.canvas as HTMLCanvasElement).height = this.height;\n    if (this.enableHit) {\n      this.provider.hitContext = (this.$refs.hitCanvas as HTMLCanvasElement)\n        .getContext('2d');\n      (this.$refs.hitCanvas as HTMLCanvasElement).width = this.width;\n      (this.$refs.hitCanvas as HTMLCanvasElement).height = this.height;\n    }\n  }\n  @Provide()\n  public generateHitColor(id: string): string {\n    if (this.provider.hitIdMap[id]) {\n      return this.provider.hitIdMap[id];\n    }\n    while (true) {\n      const r = Math.round(Math.random() * 255);\n      const g = Math.round(Math.random() * 255);\n      const b = Math.round(Math.random() * 255);\n      const color = `rgb(${r},${g},${b})`;\n      if (!this.provider.hitColorMap[color]) {\n        this.provider.hitColorMap[color] = id;\n        this.provider.hitIdMap[id] = color;\n        return color;\n      }\n    }\n  }\n  public updateCanvas() {\n    if (!this.provider.context) {\n      return;\n    }\n    const ctx: CanvasRenderingContext2D = this.provider.context;\n    const hitCtx = this.provider.hitContext;\n    ctx.clearRect(0, 0, this.width, this.height);\n    if (hitCtx) {\n      hitCtx.clearRect(0, 0, this.width, this.height);\n      this.provider.hitColorMap = {};\n      this.provider.hitIdMap = {};\n    }\n    const updateShape = (shape: any,\n                         draggable: boolean,\n                         draggableId: string) => {\n      switch (shape.is) {\n        case 'group': case 'MyGroup': {\n          ctx.save();\n          ctx.translate(shape.x || 0, shape.y || 0);\n          ctx.scale(shape.scaleX || 1, shape.scaleY || 1);\n          if (hitCtx) {\n            hitCtx.save();\n            hitCtx.translate(shape.x || 0, shape.y || 0);\n            hitCtx.scale(shape.scaleX || 1, shape.scaleY || 1);\n          }\n          if (shape.children) {\n            for (const childShape of shape.children) {\n              updateShape(childShape, shape.draggable || draggable,\n                shape.id || draggableId);\n            }\n          }\n          ctx.restore();\n          if (hitCtx) {\n            hitCtx.restore();\n          }\n          break;\n        }\n        case 'rect': case 'MyRect': {\n          ctx.beginPath();\n          ctx.rect(shape.x || 0, shape.y || 0,\n            shape.width || 0, shape.height || 0);\n          if (shape.fill) {\n            ctx.fillStyle = shape.fill;\n            ctx.fill();\n          }\n          if (shape.stroke) {\n            ctx.lineWidth = shape.strokeWidth || 1;\n            ctx.strokeStyle = shape.stroke;\n            ctx.stroke();\n          }\n          const finalDraggable = shape.draggable ||\n            (shape.draggable !== false && draggable);\n          const finalId = shape.id || draggableId;\n          if (hitCtx && finalDraggable && finalId) {\n            const color = this.generateHitColor(finalId);\n            hitCtx.beginPath();\n            hitCtx.rect(shape.x || 0, shape.y || 0,\n              shape.width || 0, shape.height || 0);\n            hitCtx.fillStyle = color;\n            hitCtx.fill();\n            if (shape.stroke) {\n              hitCtx.lineWidth = shape.strokeWidth || 1;\n              hitCtx.strokeStyle = color;\n              hitCtx.stroke();\n            }\n          }\n          break;\n        }\n        case 'text': case 'MyText': {\n          const fontSize = shape.fontSize || 12;\n          const lineHeight = shape.lineHeight || 1.2;\n          const padding = shape.padding || 4;\n          ctx.font = `${fontSize}px ${shape.fontFamily || 'sans-serif'}`;\n          const lines = shape.text ? shape.text.split('\\n') : [];\n          const linesWidth = lines.map((x: string) => ctx.measureText(x).width);\n          const width = Math.max(...linesWidth, 0);\n          let posY = (shape.y || 0) + padding;\n          ctx.textBaseline = 'top';\n          ctx.fillStyle = shape.fill || 'black';\n          for (let i = 0; i < lines.length; ++i) {\n            let posX = (shape.x || 0) + padding;\n            if (shape.align === 'left') {\n              // do nothing\n            } else if (shape.align === 'right') {\n              posX += width - linesWidth[i];\n            } else {\n              posX += (width - linesWidth[i]) / 2;\n            }\n            ctx.fillText(lines[i], posX,\n              posY + 0.5 * (lineHeight - 1) * fontSize);\n            posY += lineHeight * fontSize;\n          }\n          break;\n        }\n        case 'line': case 'MyLine': {\n          const points = shape.points || [];\n          ctx.strokeStyle = shape.stroke || 'black';\n          ctx.lineWidth = shape.strokeWidth || 1;\n          ctx.beginPath();\n          ctx.moveTo(points[0] || 0, points[1] || 0);\n          ctx.lineTo(points[2] || 0, points[3] || 0);\n          ctx.stroke();\n          break;\n        }\n        case 'quadraticLine': case 'MyQuadraticLine': {\n          const points = shape.points || [];\n          ctx.strokeStyle = shape.stroke || 'black';\n          ctx.lineWidth = shape.strokeWidth || 1;\n          ctx.beginPath();\n          ctx.moveTo(points[0] || 0, points[1] || 0);\n          ctx.quadraticCurveTo(points[2] || 0, points[3] || 0,\n            points[4] || 0, points[5] || 0);\n          ctx.stroke();\n          break;\n        }\n        case 'pointer': case 'MyPointer': {\n          const x = shape.x || 0;\n          const y = shape.y || 0;\n          const angle = shape.angle || 0;\n          const width = shape.width || 10;\n          const height = shape.height || 15;\n          const middleX = x + height * Math.cos(angle);\n          const middleY = y + height * Math.sin(angle);\n          const deltaX = width / 2 * Math.sin(angle);\n          const deltaY = -width / 2 * Math.cos(angle);\n          ctx.fillStyle = shape.fill || 'black';\n          ctx.beginPath();\n          ctx.moveTo(x, y);\n          ctx.lineTo(middleX + deltaX, middleY + deltaY);\n          ctx.lineTo(middleX - deltaX, middleY - deltaY);\n          ctx.closePath();\n          ctx.fill();\n          break;\n        }\n        case 'rectWithWhole': {\n          const points = shape.points || [];\n          ctx.beginPath();\n          ctx.moveTo(shape.outerLeft || 0, shape.outerTop || 0);\n          ctx.lineTo(shape.outerRight || 0, shape.outerTop || 0);\n          ctx.lineTo(shape.outerRight || 0, shape.outerBottom || 0);\n          ctx.lineTo(shape.outerLeft || 0, shape.outerBottom || 0);\n          ctx.lineTo(shape.outerLeft || 0, shape.outerTop || 0);\n          ctx.moveTo(shape.innerLeft || 0, shape.innerTop || 0);\n          ctx.lineTo(shape.innerLeft || 0, shape.innerBottom || 0);\n          ctx.lineTo(shape.innerRight || 0, shape.innerBottom || 0);\n          ctx.lineTo(shape.innerRight || 0, shape.innerTop || 0);\n          ctx.lineTo(shape.innerLeft || 0, shape.innerTop || 0);\n          ctx.fillStyle = shape.fill || 'white';\n          ctx.fill();\n          break;\n        }\n        default:\n          throw new Error(`Unknown shape: ${shape.is}`);\n      }\n    };\n    if (this.data) {\n      updateShape(this.data, false, '');\n    }\n  }\n  public getIdFromHitPoint(x: number, y: number): string | undefined {\n    if (this.provider.hitContext) {\n      const pixel = this.provider.hitContext.getImageData(x, y, 1, 1).data;\n      const color = `rgb(${pixel[0]},${pixel[1]},${pixel[2]})`;\n      return this.provider.hitColorMap[color];\n    }\n  }\n  @Watch('width')\n  public onWidthChanged() {\n    (this.$refs.canvas as HTMLCanvasElement).width = this.width;\n    if (this.enableHit) {\n      (this.$refs.hitCanvas as HTMLCanvasElement).width = this.width;\n    }\n    this.updateCanvas();\n  }\n  @Watch('height')\n  public onHeightChanged() {\n    (this.$refs.canvas as HTMLCanvasElement).height = this.height;\n    if (this.enableHit) {\n      (this.$refs.hitCanvas as HTMLCanvasElement).height = this.height;\n    }\n    this.updateCanvas();\n  }\n  @Watch('data')\n  public onDataChanged() {\n    this.updateCanvas();\n  }\n}\n\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MyCanvas.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MyCanvas.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MyCanvas.vue?vue&type=template&id=6b3242e9&\"\nimport script from \"./MyCanvas.vue?vue&type=script&lang=ts&\"\nexport * from \"./MyCanvas.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Vue, Component, Prop, Watch } from 'vue-property-decorator';\nimport {globalRoot} from '@/graph/Root';\nimport MyCanvas from '@/components/renderable/MyCanvas.vue';\nimport Port from '@/graph/base/Port';\n\nVue.component('MyCanvas', MyCanvas);\n\n@Component\nexport default class Graph extends Vue {\n  @Prop({ type: Number, required: true }) public readonly width!: number;\n  @Prop({ type: Number, required: true }) public readonly height!: number;\n  @Prop({ type: Array, default() { return []; }})\n  public readonly data!: object[];\n  private x = 0;\n  private y = 0;\n  private scale = 1;\n  private size = { width: 0, height: 0 };\n  private draggedId: null | string = null;\n  private mouseDragActive = false;\n  private mouseLastCoords = {\n    x: 0,\n    y: 0,\n  };\n  private maxThumbnailLength = 160;\n  private minThumbnailLength = 100;\n  private thumbnailPadding = 10;\n  private thumbnailMouseDragActive = false;\n  private thumbnailMouseLastCoords = {\n    x: 0,\n    y: 0,\n  };\n  get stageX() {\n    return this.width / 2 + this.x;\n  }\n  get stageY() {\n    return this.height / 2 + this.y;\n  }\n  public mounted() {\n    this.updateSize();\n  }\n  @Watch('data')\n  public onDataChanged() {\n    this.updateSize();\n  }\n  public updateSize() {\n    // noinspection SuspiciousTypeOfGuard\n    if (globalRoot.child instanceof Port) {\n      this.size = globalRoot.child.getBoundingBoxSize();\n    }\n  }\n  get mainCanvasData() {\n    return {\n      is: 'group',\n      x: this.stageX,\n      y: this.stageY,\n      scaleX: this.scale,\n      scaleY: this.scale,\n      children: this.data,\n    };\n  }\n  get thumbnailCanvasData() {\n    const scale = 1 / this.thumbnailFactor;\n    function deepCopyAndRemoveDraggable(shape: any) {\n      const copy = Object.assign({}, shape);\n      if (copy.draggable) {\n        delete copy.draggable;\n      }\n      if (copy.children) {\n        copy.children = copy.children.map((x: any) =>\n          deepCopyAndRemoveDraggable(x));\n      }\n      return copy;\n    }\n    const data = this.data.map((x: any) => deepCopyAndRemoveDraggable(x));\n    const viewportX = (-this.width / 2 - this.x) / this.scale;\n    const viewportY = (-this.height / 2 - this.y) / this.scale;\n    const viewportWidth = this.width / this.scale;\n    const viewportHeight = this.height / this.scale;\n    data.push({\n      is: 'rectWithWhole',\n      id: 'mask',\n      fill: 'rgba(0,0,0,0.2)',\n      outerLeft: -this.thumbnailWidth * this.thumbnailFactor / 2,\n      outerRight: this.thumbnailWidth * this.thumbnailFactor / 2,\n      outerTop: -this.thumbnailHeight * this.thumbnailFactor / 2,\n      outerBottom: this.thumbnailHeight * this.thumbnailFactor / 2,\n      innerLeft: viewportX,\n      innerRight: viewportX + viewportWidth,\n      innerTop: viewportY,\n      innerBottom: viewportY + viewportHeight,\n    });\n    data.push({\n      is: 'rect',\n      id: 'viewport',\n      draggable: true,\n      x: viewportX,\n      y: viewportY,\n      width: viewportWidth,\n      height: viewportHeight,\n      stroke: '#3eaf7c',\n      strokeWidth: this.thumbnailFactor,\n    });\n    return {\n      is: 'group',\n      x: this.thumbnailWidth / 2,\n      y: this.thumbnailHeight / 2,\n      scaleX: scale,\n      scaleY: scale,\n      children: data,\n    };\n  }\n  get thumbnailFactor() {\n    return Math.max(this.size.width / this.maxThumbnailLength,\n      this.size.height / this.maxThumbnailLength, 1);\n  }\n  get thumbnailWidth() {\n    return Math.max(this.size.width / this.thumbnailFactor,\n      this.minThumbnailLength) + 2 * this.thumbnailPadding;\n  }\n  get thumbnailHeight() {\n    return Math.max(this.size.height / this.thumbnailFactor,\n      this.minThumbnailLength) + 2 * this.thumbnailPadding;\n  }\n  public wheel(e: WheelEvent) {\n    const scaleBy = 1.1;\n    e.preventDefault();\n    const pos = this.translateMouseEvent(e);\n    const mousePointTo = {\n      x: (pos.x - this.stageX) / this.scale,\n      y: (pos.y - this.stageY) / this.scale,\n    };\n    this.scale = e.deltaY < 0 ? this.scale * scaleBy : this.scale / scaleBy;\n    const newPos = {\n      x: -(mousePointTo.x - pos.x / this.scale) *\n        this.scale,\n      y: -(mousePointTo.y - pos.y / this.scale) *\n        this.scale,\n    };\n    this.x = newPos.x - this.width / 2;\n    this.y = newPos.y - this.height / 2;\n  }\n  public translateMouseEvent(e: MouseEvent): {x: number, y: number} {\n    let elementOffsetX = 0;\n    let elementOffsetY = 0;\n    let target = e.currentTarget;\n    while (target) {\n      elementOffsetX += (target as HTMLElement).offsetLeft;\n      elementOffsetY += (target as HTMLElement).offsetTop;\n      target = (target as HTMLElement).offsetParent;\n    }\n    return {\n      x: e.pageX - elementOffsetX,\n      y: e.pageY - elementOffsetY,\n    };\n  }\n  public mousedown(e: MouseEvent) {\n    this.mouseDragActive = true;\n    this.mouseLastCoords = {\n      x: e.pageX,\n      y: e.pageY,\n    };\n    const pos = this.translateMouseEvent(e);\n    const id = (this.$refs.mainCanvas as any).getIdFromHitPoint(pos.x, pos.y);\n    if (id) {\n      this.draggedId = id;\n    }\n  }\n  public mouseup() {\n    this.mouseDragActive = false;\n    this.draggedId = null;\n  }\n  public mousemove(e: MouseEvent) {\n    if (e.buttons === 0) {\n      this.mouseDragActive = false;\n    }\n    if (this.mouseDragActive || this.draggedId) {\n      const newCoords = {\n        x: e.pageX,\n        y: e.pageY,\n      };\n      const deltaX = newCoords.x - this.mouseLastCoords.x;\n      const deltaY = newCoords.y - this.mouseLastCoords.y;\n      if (this.draggedId) {\n          globalRoot.moveDraggable(this.draggedId, {\n              deltaX: deltaX / this.scale,\n              deltaY: deltaY / this.scale,\n          });\n      } else {\n        this.x += deltaX;\n        this.y += deltaY;\n      }\n      this.mouseLastCoords = newCoords;\n    }\n  }\n  public thumbnailMousedown(e: MouseEvent) {\n    const pos = this.translateMouseEvent(e);\n    const id = (this.$refs.thumbnailCanvas as any)\n      .getIdFromHitPoint(pos.x, pos.y);\n    if (id === 'viewport') {\n      this.thumbnailMouseDragActive = true;\n      this.thumbnailMouseLastCoords = {\n        x: e.pageX,\n        y: e.pageY,\n      };\n    }\n  }\n  public thumbnailMouseup() {\n    this.thumbnailMouseDragActive = false;\n  }\n  public thumbnailMousemove(e: MouseEvent) {\n    if (e.buttons === 0) {\n      this.thumbnailMouseDragActive = false;\n    }\n    if (this.thumbnailMouseDragActive) {\n      const newCoords = {\n        x: e.pageX,\n        y: e.pageY,\n      };\n      const oldCoords = this.thumbnailMouseLastCoords;\n      const scale = this.thumbnailFactor * this.scale;\n      this.x -= (newCoords.x - oldCoords.x) * scale;\n      this.y -= (newCoords.y - oldCoords.y) * scale;\n      this.thumbnailMouseLastCoords = newCoords;\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Graph.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Graph.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Graph.vue?vue&type=template&id=83e88e6a&scoped=true&\"\nimport script from \"./Graph.vue?vue&type=script&lang=ts&\"\nexport * from \"./Graph.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Graph.vue?vue&type=style&index=0&id=83e88e6a&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"83e88e6a\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Vue, Component, Watch } from 'vue-property-decorator';\nimport CollapsiblePane from './components/CollapsiblePane.vue';\nimport Graph from './components/Graph.vue';\nimport {\n  globalRoot,\n  globalParsers,\n  globalExamples,\n} from './graph/Root';\nimport 'vue-awesome/icons/upload';\nimport 'vue-awesome/icons/sync';\nimport _ from 'lodash';\n\n@Component({\n  components: {\n    CollapsiblePane,\n    Graph,\n  },\n})\nexport default class App extends Vue {\n  get desktopLayout() {\n    return this.windowWidth > 719;\n  }\n  get realSettingsWidth() {\n    return this.desktopLayout ? this.settingsWidth : this.canvasWidth;\n  }\n  // UI data\n  // noinspection JSUnusedLocalSymbols\n  private settingsOpen = true;\n  private settingsWidth = 300;\n  private minGraphWidth = 150;\n  private minSettingsWidth = 150;\n  private sizerMouseActive = false;\n  private sizerTouchActive = false;\n  private windowWidth = document.documentElement.clientWidth;\n  private windowHeight = document.documentElement.clientHeight;\n  private canvasWidth = 0;\n  private canvasHeight = 0;\n  // Input data\n  private parser = 'json';\n  private rawInput = '';\n  private parseError = null;\n  private parsedInput = '';\n  // noinspection JSUnusedLocalSymbols\n  private examples = globalExamples;\n  // Rendered data\n  // noinspection JSMismatchedCollectionQueryUpdate\n  private rendered: object[] = [];\n  public parseInput() {\n    try {\n      if (this.rawInput) {\n        const parsed = globalParsers[this.parser](this.rawInput);\n        this.parsedInput = JSON.stringify(parsed, null, 2);\n        globalRoot.setData(parsed);\n      } else {\n        this.parsedInput = '';\n      }\n      this.parseError = null;\n    } catch (e) {\n      /* tslint:disable:no-console */\n      console.log(e);\n      this.parseError = e.stack;\n    }\n  }\n  public mounted() {\n    window.addEventListener('resize', this.getSize);\n    this.updateCanvasSize();\n    globalRoot.addEventListener('render', _.throttle((data: object[]) => {\n      this.rendered = data;\n      /* tslint:disable:no-console */\n      // console.log(JSON.stringify(data, null, 2));\n    }, 1000 / 60));\n  }\n  public beforeDestroy() {\n    window.removeEventListener('resize', this.getSize);\n  }\n  @Watch('settingsWidth')\n  public onSettingsWidthChanged() {\n    this.updateCanvasSize();\n  }\n  @Watch('parser')\n  public onParserChanged() {\n    this.parseInput();\n  }\n  @Watch('rawInput')\n  public onRawInputChanged() {\n    this.parseInput();\n  }\n  public redraw() {\n    globalRoot.redraw(JSON.parse(this.parsedInput));\n  }\n  public selectExample(i: number) {\n    const example = globalExamples[i];\n    this.parser = example.parser;\n    this.rawInput = example.content;\n  }\n  public inputFileChange(e: InputEvent) {\n    const file = (e.target as HTMLInputElement).files![0];\n    if (!file) {\n      return;\n    }\n    switch (file.type) {\n      case 'application/json':\n        this.parser = 'json';\n        break;\n      case 'text/vnd.graphviz':\n        this.parser = 'graphviz';\n        break;\n      default:\n        alert('Unknown file type');\n        return;\n    }\n    const reader = new FileReader();\n    reader.onload = (evt: ProgressEvent<FileReader>) => {\n      this.rawInput = evt.target!.result as string;\n    };\n    reader.readAsText(file);\n  }\n  public getSize() {\n    this.windowWidth = document.documentElement.clientWidth;\n    this.windowHeight = document.documentElement.clientHeight;\n    this.$nextTick(() => this.updateCanvasSize());\n  }\n  public updateCanvasSize() {\n    this.canvasWidth = (this.$refs.canvas as HTMLElement).offsetWidth;\n    this.canvasHeight = (this.$refs.canvas as HTMLElement).offsetHeight;\n    // globalRoot.setViewportSize(this.canvasWidth, this.canvasHeight);\n  }\n  public onMainSizerMouseDown() {\n    this.sizerMouseActive = true;\n  }\n  public onMainSizerMouseUp() {\n    this.sizerMouseActive = false;\n  }\n  public onMainSizerMouseMove(e: MouseEvent) {\n    if (e.buttons === 0) {\n      this.sizerMouseActive = false;\n    }\n    if (this.sizerMouseActive) {\n      let elementOffsetX = 0;\n      let target = e.currentTarget;\n      while (target) {\n        elementOffsetX += (target as HTMLElement).offsetLeft;\n        target = (target as HTMLElement).offsetParent;\n      }\n      const mouseOffsetX = e.pageX;\n      const width = (e.currentTarget! as HTMLElement).offsetWidth;\n      const offsetX = mouseOffsetX - elementOffsetX;\n      if (offsetX >= this.minGraphWidth &&\n        (width - offsetX) >= this.minSettingsWidth) {\n        this.settingsWidth = Math.round(width - offsetX);\n      }\n    }\n  }\n  public onMainSizerTouchStart() {\n    this.sizerTouchActive = true;\n  }\n  public onMainSizerTouchEnd() {\n    this.sizerTouchActive = false;\n  }\n  public onMainSizerTouchMove(e: TouchEvent) {\n    if (this.sizerTouchActive) {\n      let elementOffsetX = 0;\n      let target = e.currentTarget;\n      while (target) {\n        elementOffsetX += (target as HTMLElement).offsetLeft;\n        target = (target as HTMLElement).offsetParent;\n      }\n      const mouseOffsetX = e.touches[0].pageX;\n      const width = (e.currentTarget! as HTMLElement).offsetWidth;\n      const offsetX = mouseOffsetX - elementOffsetX;\n      if (offsetX >= this.minGraphWidth &&\n        (width - offsetX) >= this.minSettingsWidth) {\n        this.settingsWidth = Math.round(width - offsetX);\n      }\n    }\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=2f9a91d6&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=stylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue';\nimport Icon from 'vue-awesome/components/Icon.vue';\nimport App from './App.vue';\n\nVue.config.productionTip = false;\n\nVue.component('v-icon', Icon);\n\nnew Vue({\n  render: (h) => h(App),\n}).$mount('#app');\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollapsiblePane.vue?vue&type=style&index=0&id=08120549&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollapsiblePane.vue?vue&type=style&index=0&id=08120549&lang=stylus&scoped=true&\""],"sourceRoot":""}